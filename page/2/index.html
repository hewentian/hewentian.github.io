<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Tim Ho&#39;s Technology Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="my personal blog">
<meta property="og:type" content="website">
<meta property="og:title" content="Tim Ho&#39;s Technology Blog">
<meta property="og:url" content="https://github.com/hewentian/page/2/index.html">
<meta property="og:site_name" content="Tim Ho&#39;s Technology Blog">
<meta property="og:description" content="my personal blog">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Tim Ho&#39;s Technology Blog">
<meta name="twitter:description" content="my personal blog">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Tim Ho&#39;s Technology Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">心如止水</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives/">Archives</a>
        
          <a class="main-nav-link" href="/categories/">Categories</a>
        
          <a class="main-nav-link" href="/tags/">Tags</a>
        
          <a class="main-nav-link" href="/about/">About</a>
        
      </nav>
      <nav id="sub-nav">
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://github.com/hewentian"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-html-css" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/11/10/html-css/" class="article-date">
  <time datetime="2017-11-09T16:37:57.000Z" itemprop="datePublished">2017-11-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/other/">other</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/11/10/html-css/">html-css前端相关</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>将图片二进制流显示在html端的img控件中，在获取验证码的时候用得比较多，方法如下<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"data:image/jpeg;base64,fejwiqpofewqlfjewqjfewopfjef..."</span>&gt;</span></span><br><span class="line"></span><br><span class="line">在 src 后面加上 data:image/jpeg;base64,二进制码.</span><br></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/hewentian/2017/11/10/html-css/" data-id="cjcpkyc7p0002y02i1qmudn49" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-java-get-entity-property-and-value" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/11/10/java-get-entity-property-and-value/" class="article-date">
  <time datetime="2017-11-09T16:16:59.000Z" itemprop="datePublished">2017-11-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/java/">java</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/11/10/java-get-entity-property-and-value/">java 获取对象的所有属性和它们的值</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>下面我们展示如何获取对象的所有属性和它们的值，首先我们新建一个实体类：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * &lt;b&gt;User&lt;/b&gt; 是 测试用的类</span></span><br><span class="line"><span class="comment"> * &lt;/p&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> &lt;a href="mailto:wentian.he@qq.com"&gt;hewentian&lt;/a&gt;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2017年11月10日 上午12:19:18</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> JDK 1.8</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">	<span class="comment">/** id */</span></span><br><span class="line">	<span class="keyword">private</span> Integer id;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/** 姓名 */</span></span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/** 年龄 */</span></span><br><span class="line">	<span class="keyword">private</span> Integer age;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(Integer id, String name, Integer age)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">		<span class="keyword">this</span>.id = id;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">		<span class="keyword">this</span>.age = age;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Integer <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> id;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.id = id;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Integer <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> age;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(Integer age)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.age = age;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这里我们用到了<code>apache</code>提供的工具包<code>commons-beanutils-1.9.3.jar</code>，详细代码如下：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.beans.PropertyDescriptor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.beanutils.PropertyUtils;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * &lt;b&gt;GetPropertyAndValue&lt;/b&gt; 是 获取对象的所有属性和它们的值</span></span><br><span class="line"><span class="comment"> * &lt;/p&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> &lt;a href="mailto:wentian.he@qq.com"&gt;hewentian&lt;/a&gt;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2017年11月10日 上午12:20:09</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> JDK 1.8</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GetPropertyAndValue</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		User user = <span class="keyword">new</span> User(<span class="number">1</span>, <span class="string">"Tim Ho"</span>, <span class="number">23</span>);</span><br><span class="line"></span><br><span class="line">		List&lt;String&gt; properties = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line"></span><br><span class="line">		System.out.println(<span class="string">"获取所有属性"</span>);</span><br><span class="line">		PropertyDescriptor[] pds = PropertyUtils.getPropertyDescriptors(user.getClass());</span><br><span class="line">		<span class="keyword">for</span> (PropertyDescriptor pd : pds) &#123;</span><br><span class="line">			System.out.println(pd.getName() + <span class="string">"\t"</span> + pd.getPropertyType());</span><br><span class="line">			properties.add(pd.getName());</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		System.out.println(<span class="string">"\n根据属性获取这个属性的值"</span>);</span><br><span class="line">		properties.stream().forEach(p -&gt; &#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				Object value = PropertyUtils.getProperty(user, p);</span><br><span class="line">				System.out.println(p + <span class="string">"\t"</span> + value);</span><br><span class="line">			&#125; <span class="keyword">catch</span> (IllegalAccessException | InvocationTargetException | NoSuchMethodException e) &#123;</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>输出结果如下：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">获取所有属性</span><br><span class="line">name	<span class="class"><span class="keyword">class</span> <span class="title">java</span>.<span class="title">lang</span>.<span class="title">String</span></span></span><br><span class="line"><span class="class"><span class="title">id</span>	<span class="title">class</span> <span class="title">java</span>.<span class="title">lang</span>.<span class="title">Integer</span></span></span><br><span class="line"><span class="class"><span class="title">class</span>	<span class="title">class</span> <span class="title">java</span>.<span class="title">lang</span>.<span class="title">Class</span></span></span><br><span class="line"><span class="class"><span class="title">age</span>	<span class="title">class</span> <span class="title">java</span>.<span class="title">lang</span>.<span class="title">Integer</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">根据属性获取这个属性的值</span></span><br><span class="line"><span class="class"><span class="title">name</span>	<span class="title">Tim</span> <span class="title">Ho</span></span></span><br><span class="line"><span class="class"><span class="title">id</span>	1</span></span><br><span class="line"><span class="class"><span class="title">class</span>	<span class="title">class</span> <span class="title">com</span>.<span class="title">wtoip</span>.<span class="title">yun</span>.<span class="title">dungbeetle</span>.<span class="title">User</span></span></span><br><span class="line"><span class="class"><span class="title">age</span>	23</span></span><br></pre></td></tr></table></figure></p>
<p>end.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/hewentian/2017/11/10/java-get-entity-property-and-value/" data-id="cjcpkyc890006y02i60ohpkat" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-solr-note" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/10/29/solr-note/" class="article-date">
  <time datetime="2017-10-29T04:12:26.000Z" itemprop="datePublished">2017-10-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/bigdata/">bigdata</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/10/29/solr-note/">solr学习笔记</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="HttpSolrClient"><a href="#HttpSolrClient" class="headerlink" title="HttpSolrClient"></a>HttpSolrClient</h3><p>HttpSolrClient 使用 HTTPClient 和 solr 服务器进行通信。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.solr.client.solrj.impl.HttpSolrClient;</span><br><span class="line"></span><br><span class="line">String baseSolrUrl = <span class="string">"http://localhost:8983/solr/"</span>;</span><br><span class="line"></span><br><span class="line">HttpSolrClient solrClient = <span class="keyword">new</span> HttpSolrClient.Builder().withBaseSolrUrl(baseSolrUrl).build();</span><br><span class="line">solrClient.setConnectionTimeout(<span class="number">1000</span>);</span><br><span class="line">solrClient.setDefaultMaxConnectionsPerHost(<span class="number">100</span>);</span><br><span class="line">solrClient.setMaxTotalConnections(<span class="number">100</span>);</span><br></pre></td></tr></table></figure></p>
<p>HttpSolrClient 是线程安全的，建议重复使用 HttpSolrClient 实例。</p>
<h3 id="EmbeddedSolrServer"><a href="#EmbeddedSolrServer" class="headerlink" title="EmbeddedSolrServer"></a>EmbeddedSolrServer</h3><p>EmbeddedSolrServer 提供和 HttpSolrClient 相同的接口，它不需要http连接。如果，你使用的是一个本地的 solrServer 的话，这是一个不错的选择。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.solr.client.solrj.embedded.EmbeddedSolrServer;</span><br><span class="line"><span class="keyword">import</span> org.apache.solr.core.CoreContainer;</span><br><span class="line"></span><br><span class="line">System.setProperty(<span class="string">"solr.solr.home"</span>, <span class="string">"/home/hewentian/ProjectD/solr-6.5.0/server/solr"</span>);</span><br><span class="line">		</span><br><span class="line">CoreContainer coreContainer = <span class="keyword">new</span> CoreContainer(<span class="string">"/home/hewentian/ProjectD/solr-6.5.0/server/solr"</span>);</span><br><span class="line">coreContainer.load(); <span class="comment">// don't forge to invoke this method since solr 4.4.0</span></span><br><span class="line">		</span><br><span class="line">EmbeddedSolrServer embeddedSolrServer = <span class="keyword">new</span> EmbeddedSolrServer(coreContainer, coreName);</span><br></pre></td></tr></table></figure></p>
<p>通过 POJO 方式往 Solr 中添加 doc 时，要使用 注解<code>@org.apache.solr.client.solrj.beans.Field</code>，@Field 可以被用在域上，或者是setter方法上。如果一个域的名称跟bean的名称是不一样的，那么在java注释中填写别名，具体的，可以参照下面的例子：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">	<span class="comment">/** 用户id */</span></span><br><span class="line">	<span class="meta">@Field</span></span><br><span class="line">	<span class="keyword">private</span> String id;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/** 名字 */</span></span><br><span class="line">	<span class="meta">@Field</span></span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/** 年龄 */</span></span><br><span class="line">	<span class="meta">@Field</span></span><br><span class="line">	<span class="keyword">private</span> Integer age;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// getter setter method</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>当将一个 doc 往 solr 中添加之后，要记得调用 commit 方法，当然，如果在 solrconfig.xml 中有配置硬/软提交的，可以省略<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SolrClient solrClient = createSolrClient(baseSolrUrl);</span><br><span class="line">UpdateResponse response = solrClient.addBean(collection, user);</span><br><span class="line"></span><br><span class="line">solrClient.commit(collection);</span><br><span class="line">solrClient.close();</span><br></pre></td></tr></table></figure></p>
<p>Group 分组划分结果，返回的是分组结果；<br>Facet 分组统计，侧重统计，返回的是分组后的数量；<br>下面分别说下</p>
<h3 id="Facet查询"><a href="#Facet查询" class="headerlink" title="Facet查询"></a>Facet查询</h3><p>进行Facet查询需要在请求参数中加入”facet=on”或者”facet=true”只有这样Facet组件才起作用.<br>搜索结果按照Facet的字段分组并统计<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">SolrQuery solrQuery = <span class="keyword">new</span> SolrQuery();</span><br><span class="line">solrQuery.setQuery(<span class="string">"老师"</span>);</span><br><span class="line">solrQuery.setFacet(<span class="keyword">true</span>);</span><br><span class="line">solrQuery.setFacetMinCount(<span class="number">1</span>); <span class="comment">// 统计结果大于 1 的才会返回</span></span><br><span class="line">solrQuery.setFacetLimit(<span class="number">10</span>); <span class="comment">// 对于每一个 field 最多返回 10 个结果</span></span><br><span class="line">solrQuery.addFacetField(<span class="string">"age"</span>, <span class="string">"name"</span>);</span><br><span class="line">solrQuery.setRows(<span class="number">0</span>); <span class="comment">// 设置返回结果条数，如果分组查询，就设置为0</span></span><br><span class="line"></span><br><span class="line">QueryResponse queryResponse = SolrUtils.getQueryResponse(baseSolrUrl, collection, solrQuery);</span><br><span class="line">List&lt;FacetField&gt; facetFields = queryResponse.getFacetFields();</span><br><span class="line">facetFields.stream().forEach(ff -&gt; &#123;</span><br><span class="line">	ff.getValues().stream().forEach(c -&gt; &#123;</span><br><span class="line">		System.out.println(c.getName() + <span class="string">", "</span> + c.getCount());</span><br><span class="line">	&#125;);</span><br><span class="line">	System.out.println();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">///~: output</span></span><br><span class="line"><span class="number">50</span>, <span class="number">3</span></span><br><span class="line"><span class="number">20</span>, <span class="number">2</span></span><br><span class="line"><span class="number">40</span>, <span class="number">1</span></span><br><span class="line"></span><br><span class="line">陈六, <span class="number">2</span></span><br><span class="line">张三, <span class="number">1</span></span><br><span class="line">李七, <span class="number">1</span></span><br><span class="line">李四, <span class="number">1</span></span><br><span class="line">王五, <span class="number">1</span></span><br></pre></td></tr></table></figure></p>
<p>facet的参数见solr官方wiki  <a href="http://wiki.apache.org/solr/SimpleFacetParameters" target="_blank" rel="noopener">http://wiki.apache.org/solr/SimpleFacetParameters</a></p>
<p>facet 参数字段要求:<br>1.字段必须被索引<br>2.facet=on 或 facet=true</p>
<p>1.facet.field<br>分组的字段<br>2.facet.prefix<br>表示Facet字段前缀<br>3.facet.limit<br>Facet字段返回条数<br>4.facet.offict<br>开始条数,偏移量,它与facet.limit配合使用可以达到分页的效果<br>5.facet.mincount<br>Facet字段最小count,默认为0<br>6.facet.missing<br>如果为on或true,那么将统计那些Facet字段值为null的记录<br>7.facet.method<br>取值为enum或fc,默认为fc, fc表示Field Cache<br>8.facet.enum.cache.minDf<br>当facet.method=enum时,参数起作用,文档内出现某个关键字的最少次数</p>
<h3 id="Group查询"><a href="#Group查询" class="headerlink" title="Group查询"></a>Group查询</h3><p>分组统计查询不同于分组统计（Facet），facet只是简单统计记录数，并不能为每组数据返回实际的数据回来，solr提供的grouping查询能够解决这一问题，也就是说，他除了能分组外，还能把每组数据返回来。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">SolrQuery solrQuery = <span class="keyword">new</span> SolrQuery();</span><br><span class="line">solrQuery.setQuery(<span class="string">"*:*"</span>);</span><br><span class="line">solrQuery.set(GroupParams.GROUP, <span class="keyword">true</span>);</span><br><span class="line">solrQuery.set(GroupParams.GROUP_FIELD, <span class="string">"age"</span>, <span class="string">"name"</span>);</span><br><span class="line">solrQuery.set(GroupParams.GROUP_LIMIT, <span class="number">3</span>);</span><br><span class="line">solrQuery.set(GroupParams.GROUP_FORMAT, <span class="string">"grouped"</span>);</span><br><span class="line">solrQuery.set(GroupParams.GROUP_MAIN, <span class="keyword">false</span>);</span><br><span class="line">solrQuery.set(GroupParams.GROUP_TOTAL_COUNT, <span class="keyword">true</span>);</span><br><span class="line">solrQuery.set(GroupParams.GROUP_SORT, <span class="string">"age asc"</span>);</span><br><span class="line"></span><br><span class="line">QueryResponse queryResponse = SolrUtils.getQueryResponse(baseSolrUrl, collection, solrQuery);</span><br><span class="line"><span class="comment">// 通过GroupResponse获取GroupCommand，进而通过GroupCommand获取Group，而Group又可以获得SolrDocumentList</span></span><br><span class="line">GroupResponse groupResponse = queryResponse.getGroupResponse();</span><br><span class="line">List&lt;GroupCommand&gt; groupCommands = groupResponse.getValues();</span><br><span class="line"><span class="keyword">for</span> (GroupCommand gc : groupCommands) &#123;</span><br><span class="line">	System.out.println(<span class="string">"\n########## group name: "</span> + gc.getName());</span><br><span class="line">	<span class="comment">// 只有设置 GroupParams.GROUP_TOTAL_COUNT 这里 getNGroups 才有效果</span></span><br><span class="line">	System.out.println(<span class="string">"########## Num of Groups Found: "</span> + gc.getNGroups()); </span><br><span class="line">	System.out.println(<span class="string">"########## Num of documents Found: "</span> + gc.getMatches());</span><br><span class="line"></span><br><span class="line">	List&lt;Group&gt; groups = gc.getValues();</span><br><span class="line">	<span class="keyword">for</span> (Group g : groups) &#123;</span><br><span class="line">		SolrDocumentList solrDocumentList = g.getResult();</span><br><span class="line">		System.out.println(<span class="string">"\n########## group name: "</span> + gc.getName() + <span class="string">", groupValue: "</span> + g.getGroupValue()</span><br><span class="line">				+ <span class="string">", Num of Documents in this group: "</span> + solrDocumentList.getNumFound());</span><br><span class="line">		<span class="keyword">if</span> (CollectionUtils.isNotEmpty(solrDocumentList)) &#123;</span><br><span class="line">			<span class="keyword">for</span> (SolrDocument sd : solrDocumentList) &#123;</span><br><span class="line">				System.out.println(sd);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="solr建立索引的过程和查询过程"><a href="#solr建立索引的过程和查询过程" class="headerlink" title="solr建立索引的过程和查询过程"></a>solr建立索引的过程和查询过程</h2><h3 id="solr索引建立："><a href="#solr索引建立：" class="headerlink" title="solr索引建立："></a>solr索引建立：</h3><p>第一步：solr会对句子进行空格分隔，比如对 JAVA is a kind of computer language 分词，分为JAVA，is，a，kind，of，computer，language;</p>
<p>第二步：solr会对上面分出来的词，去掉停用词，这里比如a，is;</p>
<p>第三部：solr会对上面分出来的英文都转化为小写 java,kind,of,computer,language。</p>
<h3 id="solr查询过程："><a href="#solr查询过程：" class="headerlink" title="solr查询过程："></a>solr查询过程：</h3><p>第一步：同索引过程；</p>
<p>第二步：同索引过程；</p>
<p>第三部：同索引过程；</p>
<p>最后分词匹配成功，那么索引的那句话就会被查询出来，这里需要注意：索引和查询的分词器必须使用一样的！！！</p>
<h2 id="下面说说Solr基础"><a href="#下面说说Solr基础" class="headerlink" title="下面说说Solr基础"></a>下面说说Solr基础</h2><p>部分内容转载自如下网址，详情请参阅：<br><a href="http://blog.csdn.net/awj3584/article/details/16963525" target="_blank" rel="noopener">http://blog.csdn.net/awj3584/article/details/16963525</a><br><a href="https://lucene.apache.org/solr/guide/" target="_blank" rel="noopener">https://lucene.apache.org/solr/guide/</a><br>以下部分为抄录内容</p>
<h3 id="types-部分"><a href="#types-部分" class="headerlink" title="types 部分"></a>types 部分</h3><p>是一些常见的可重用定义，定义了 Solr（和 Lucene）如何处理 Field。也就是添加到索引中的xml文件属性中的类型，如int、text、date等.<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">fieldType</span> <span class="attr">name</span>=<span class="string">"string"</span> <span class="attr">class</span>=<span class="string">"solr.StrField"</span> <span class="attr">sortMissingLast</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">fieldType</span> <span class="attr">name</span>=<span class="string">"boolean"</span> <span class="attr">class</span>=<span class="string">"solr.BoolField"</span> <span class="attr">sortMissingLast</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">fieldType</span> <span class="attr">name</span>=<span class="string">"int"</span> <span class="attr">class</span>=<span class="string">"solr.TrieIntField"</span> <span class="attr">precisionStep</span>=<span class="string">"0"</span> <span class="attr">positionIncrementGap</span>=<span class="string">"0"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">fieldType</span> <span class="attr">name</span>=<span class="string">"text_general"</span> <span class="attr">class</span>=<span class="string">"solr.TextField"</span> <span class="attr">positionIncrementGap</span>=<span class="string">"100"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">analyzer</span> <span class="attr">type</span>=<span class="string">"index"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tokenizer</span> <span class="attr">class</span>=<span class="string">"solr.StandardTokenizerFactory"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">"solr.StopFilterFactory"</span> <span class="attr">ignoreCase</span>=<span class="string">"true"</span> <span class="attr">words</span>=<span class="string">"stopwords.txt"</span> <span class="attr">enablePositionIncrements</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">"solr.LowerCaseFilterFactory"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">analyzer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">analyzer</span> <span class="attr">type</span>=<span class="string">"query"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tokenizer</span> <span class="attr">class</span>=<span class="string">"solr.StandardTokenizerFactory"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">"solr.StopFilterFactory"</span> <span class="attr">ignoreCase</span>=<span class="string">"true"</span> <span class="attr">words</span>=<span class="string">"stopwords.txt"</span> <span class="attr">enablePositionIncrements</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">"solr.SynonymFilterFactory"</span> <span class="attr">synonyms</span>=<span class="string">"synonyms.txt"</span> <span class="attr">ignoreCase</span>=<span class="string">"true"</span> <span class="attr">expand</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">"solr.LowerCaseFilterFactory"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">analyzer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">fieldType</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>参数说明:</p>
<table>
<thead>
<tr>
<th>属性</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td style="text-align:left">标识而已</td>
</tr>
<tr>
<td>class</td>
<td style="text-align:left">和其他属性决定了这个fieldType的实际行为。</td>
</tr>
<tr>
<td>sortMissingLast</td>
<td style="text-align:left">设置成true没有该field的数据排在有该field的数据之后，而不管请求时的排序规则, 默认是设置成false。</td>
</tr>
<tr>
<td>sortMissingFirst</td>
<td style="text-align:left">跟上面倒过来呗。 默认是设置成false</td>
</tr>
<tr>
<td>analyzer</td>
<td style="text-align:left">字段类型指定的分词器</td>
</tr>
<tr>
<td>type</td>
<td style="text-align:left">当前分词用用于的操作.index代表生成索引时使用的分词器query代码在查询时使用的分词器</td>
</tr>
<tr>
<td>tokenizer</td>
<td style="text-align:left">分词器类</td>
</tr>
<tr>
<td>filter</td>
<td style="text-align:left">分词后应用的过滤器  过滤器调用顺序和配置相同.</td>
</tr>
</tbody>
</table>
<h3 id="fileds"><a href="#fileds" class="headerlink" title="fileds"></a>fileds</h3><p>是你添加到索引文件中出现的属性名称，而声明类型就需要用到上面的types<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">type</span>=<span class="string">"string"</span> <span class="attr">indexed</span>=<span class="string">"true"</span> <span class="attr">stored</span>=<span class="string">"true"</span> <span class="attr">required</span>=<span class="string">"true"</span> <span class="attr">multiValued</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"path"</span> <span class="attr">type</span>=<span class="string">"text_smartcn"</span> <span class="attr">indexed</span>=<span class="string">"false"</span> <span class="attr">stored</span>=<span class="string">"true"</span> <span class="attr">multiValued</span>=<span class="string">"false"</span> <span class="attr">termVector</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"content"</span> <span class="attr">type</span>=<span class="string">"text_smartcn"</span> <span class="attr">indexed</span>=<span class="string">"false"</span> <span class="attr">stored</span>=<span class="string">"true"</span> <span class="attr">multiValued</span>=<span class="string">"false"</span> <span class="attr">termVector</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span> =<span class="string">"text"</span> <span class="attr">type</span> =<span class="string">"text_ik"</span> <span class="attr">indexed</span> =<span class="string">"true"</span> <span class="attr">stored</span> =<span class="string">"false"</span> <span class="attr">multiValued</span> =<span class="string">"true"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span> =<span class="string">"pinyin"</span> <span class="attr">type</span> =<span class="string">"text_pinyin"</span> <span class="attr">indexed</span> =<span class="string">"true"</span> <span class="attr">stored</span> =<span class="string">"false"</span> <span class="attr">multiValued</span> =<span class="string">"false"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"_version_"</span> <span class="attr">type</span>=<span class="string">"long"</span> <span class="attr">indexed</span>=<span class="string">"true"</span> <span class="attr">stored</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dynamicField</span> <span class="attr">name</span>=<span class="string">"*_i"</span> <span class="attr">type</span>=<span class="string">"int"</span> <span class="attr">indexed</span>=<span class="string">"true"</span> <span class="attr">stored</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dynamicField</span> <span class="attr">name</span>=<span class="string">"*_l"</span> <span class="attr">type</span>=<span class="string">"long"</span> <span class="attr">indexed</span>=<span class="string">"true"</span> <span class="attr">stored</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dynamicField</span> <span class="attr">name</span>=<span class="string">"*_s"</span> <span class="attr">type</span>=<span class="string">"string"</span> <span class="attr">indexed</span>=<span class="string">"true"</span> <span class="attr">stored</span>=<span class="string">"true"</span> /&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>field: 固定的字段设置<br>dynamicField: 动态的字段设置,用于后期自定义字段,*号通配符.例如: test_i就是int类型的动态字段.<br>还有一个特殊的字段copyField,一般用于检索时用的字段这样就只对这一个字段进行索引分词就行了copyField的dest属性如果有多个source一定要设置multiValued=true,否则会报错的<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">copyField</span> <span class="attr">source</span>=<span class="string">"content"</span> <span class="attr">dest</span>=<span class="string">"pinyin"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">copyField</span> <span class="attr">source</span>=<span class="string">"content"</span> <span class="attr">dest</span>=<span class="string">"text"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">copyField</span> <span class="attr">source</span>=<span class="string">"pinyin"</span> <span class="attr">dest</span>=<span class="string">"text"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"text"</span> <span class="attr">type</span>=<span class="string">"text_general"</span> <span class="attr">indexed</span>=<span class="string">"true"</span> <span class="attr">stored</span>=<span class="string">"false"</span> <span class="attr">multiValued</span>=<span class="string">"true"</span>/&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>字段属性说明:</p>
<table>
<thead>
<tr>
<th>属性</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td style="text-align:left">字段类型名</td>
</tr>
<tr>
<td>class</td>
<td style="text-align:left">java类名</td>
</tr>
<tr>
<td>indexed</td>
<td style="text-align:left">缺省true。 说明这个数据应被搜索和排序，如果数据没有indexed，则stored应是true。</td>
</tr>
<tr>
<td>stored</td>
<td style="text-align:left">缺省true。说明这个字段被包含在搜索结果中是合适的。如果数据没有stored,则indexed应是true。</td>
</tr>
<tr>
<td>omitNorms</td>
<td style="text-align:left">字段的长度不影响得分和在索引时不做boost时，设置它为true。一般文本字段不设置为true。</td>
</tr>
<tr>
<td>termVectors</td>
<td style="text-align:left">如果字段被用来做more like this 和highlight的特性时应设置为true。</td>
</tr>
<tr>
<td>compressed</td>
<td style="text-align:left">字段是压缩的。这可能导致索引和搜索变慢，但会减少存储空间，只有StrField和TextField是可以压缩，这通常适合字段的长度超过200个字符。</td>
</tr>
<tr>
<td>multiValued</td>
<td style="text-align:left">字段多于一个值的时候，可设置为true。</td>
</tr>
<tr>
<td>positionIncrementGap</td>
<td style="text-align:left">和multiValued一起使用，设置多个值之间的虚拟空白的数量</td>
</tr>
</tbody>
</table>
<p>注意:<em>version</em> 是一个特殊字段,不能删除,是记录当前索引版本号的.</p>
<p>uniqueKey: 唯一键，这里配置的是上面出现的fileds，一般是id、url等不重复的。在更新、删除的时候可以用到。<br>defaultSearchField: 默认搜索属性，如q=solr就是默认的搜索那个字段（默认搜text，其他字段的值会copy到这个field）<br>solrQueryParser: 查询转换模式，是并且还是或者（AND/OR必须大写）</p>
<h2 id="solr配置solrconfig-xml"><a href="#solr配置solrconfig-xml" class="headerlink" title="solr配置solrconfig.xml"></a>solr配置solrconfig.xml</h2><p>对于我的机器来说，是在以下目录：/home/hewentian/ProjectD/solr-6.5.0/server/solr/mysqlCore/conf/solrconfig.xml</p>
<h3 id="索引indexConfig"><a href="#索引indexConfig" class="headerlink" title="索引indexConfig"></a>索引indexConfig</h3><p>Solr 性能因素，来了解与各种更改相关的性能权衡。 下表概括了可控制 Solr 索引处理的各种因素：</p>
<table>
<thead>
<tr>
<th>属性</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>useCompoundFile</td>
<td style="text-align:left">通过将很多 Lucene 内部文件整合到一个文件来减少使用中的文件的数量。这可有助于减少 Solr 使用的文件句柄数目，代价是降低了性能。除非是应用程序用完了文件句柄，否则 false 的默认值应该就已经足够。</td>
</tr>
<tr>
<td>ramBufferSizeMB</td>
<td style="text-align:left">在添加或删除文档时，为了减少频繁的更些索引,Solr会选缓存在内存中,当内存中的文件大于设置的值,才会更新到索引库。较大的值可使索引时间变快但会牺牲较多的内存。</td>
</tr>
<tr>
<td>maxBufferedDocs</td>
<td style="text-align:left">同 ramBufferSizeMB，如两个值同时设置,满足一个就会进行刷新索引.</td>
</tr>
<tr>
<td>mergeFactor</td>
<td style="text-align:left">决定低水平的 Lucene 段被合并的频率。较小的值（最小为 2）使用的内存较少但导致的索引时间也更慢。较大的值可使索引时间变快但会牺牲较多的内存。</td>
</tr>
<tr>
<td>maxIndexingThreads</td>
<td style="text-align:left">是indexWriter生成索引时使用的最大线程数</td>
</tr>
<tr>
<td>unlockOnStartup</td>
<td style="text-align:left">unlockOnStartup 告知 Solr 忽略在多线程环境中用来保护索引的锁定机制。在某些情况下，索引可能会由于不正确的关机或其他错误而一直处于锁定，这就妨碍了添加和更新。将其设置为 true  可以禁用启动锁定，进而允许进行添加和更新。</td>
</tr>
<tr>
<td>lockType</td>
<td style="text-align:left">1. single: 在只读索引或是没有其它进程修改索引时使用. 2. native: 使用操作系统本地文件锁,不能使用多个Solr在同一个JVM中共享一个索引. 3. simple :使用一个文本文件锁定索引.</td>
</tr>
</tbody>
</table>
<h3 id="查询配置query"><a href="#查询配置query" class="headerlink" title="查询配置query"></a>查询配置query</h3><table>
<thead>
<tr>
<th>属性</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>maxBooleanClauses</td>
<td style="text-align:left">最大的BooleanQuery数量. 当值超出时，抛出 TooManyClausesException.注意这个是全局的,如果是多个SolrCore都会使用一个值,每个Core里设置不一样的话,会使用最后一个的.</td>
</tr>
<tr>
<td>filterCache</td>
<td style="text-align:left">filterCache存储了无序的lucene document id集合，1.存储了filter queries(“fq”参数)得到的document id集合结果。2.还可用于facet查询。3. 如果配置了useFilterForSortedQuery，那么如果查询有filter，则使用filterCache。</td>
</tr>
<tr>
<td>queryResultCache</td>
<td style="text-align:left">缓存搜索结果,一个文档ID列表</td>
</tr>
<tr>
<td>documentCache</td>
<td style="text-align:left">缓存Lucene的Document对象,不会自热</td>
</tr>
<tr>
<td>fieldValueCache</td>
<td style="text-align:left">字段缓存使用文档ID进行快速访问。默认情况下创建fieldValueCache即使这里没有配置。</td>
</tr>
<tr>
<td>enableLazyFieldLoading</td>
<td style="text-align:left">若应用程序预期只会检索 Document 上少数几个 Field，那么可以将属性设置为 true。延迟加载的一个常见场景大都发生在应用程序返回和显示一系列搜索结果的时候，用户常常会单击其中的一个来查看存储在此索引中的原始文档。初始的显示常常只需要显示很短的一段信息。若考虑到检索大型 Document 的代价，除非必需，否则就应该避免加载整个文档。</td>
</tr>
<tr>
<td>queryResultWindowSize</td>
<td style="text-align:left">一次查询中存储最多的doc的id数目.</td>
</tr>
<tr>
<td>queryResultMaxDocsCached</td>
<td style="text-align:left">查询结果doc的最大缓存数量, 例如要求每页显示10条,这里设置是20条,也就是说缓存里总会给你多出10条的数据.让你点示下一页时很快拿到数据.</td>
</tr>
<tr>
<td>listener</td>
<td style="text-align:left">选项定义 newSearcher 和 firstSearcher 事件，您可以使用这些事件来指定实例化新搜索程序或第一个搜索程序时应该执行哪些查询。如果应用程序期望请求某些特定的查询，那么在创建新搜索程序或第一个搜索程序时就应该反注释这些部分并执行适当的查询。</td>
</tr>
<tr>
<td>useColdSearcher</td>
<td style="text-align:left">是否使用冷搜索,为false时使用自热后的searcher</td>
</tr>
<tr>
<td>maxWarmingSearchers</td>
<td style="text-align:left">最大自热searcher数量</td>
</tr>
</tbody>
</table>
<h3 id="删除索引"><a href="#删除索引" class="headerlink" title="删除索引"></a>删除索引</h3><p>删除索引可以通过两种方式操作,一种是通过文档ID进行删除, 另一种是通过查询到的结果进行删除.<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">通过ID删除方式代码:</span><br><span class="line">solrClient.deleteById(id);</span><br><span class="line"></span><br><span class="line"><span class="comment">//或是使用批量删除</span></span><br><span class="line">solrClient.deleteById(ids);</span><br><span class="line"></span><br><span class="line">通过查询删除方式代码:</span><br><span class="line">solrClient.deleteByQuery(<span class="string">"*:*"</span>); <span class="comment">// ”*:*” 就查询所有内容的, 这样就删除了所有文档索引</span></span><br></pre></td></tr></table></figure></p>
<h3 id="优化索引"><a href="#优化索引" class="headerlink" title="优化索引"></a>优化索引</h3><p>优化Lucene 的索引文件以改进搜索性能。索引完成后执行一下优化通常比较好。如果更新比较频繁，则应该在使用率较低的时候安排优化。一个索引无需优化也可以正常地运行。优化是一个耗时较多的过程。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">solrClient.optimize(); <span class="comment">// 不要频繁的调用, 尽量在无人使用时调用</span></span><br></pre></td></tr></table></figure></p>
<h3 id="查询参数"><a href="#查询参数" class="headerlink" title="查询参数"></a>查询参数</h3><table>
<thead>
<tr>
<th>名称</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>q</td>
<td style="text-align:left">查询字符串，必须的</td>
</tr>
<tr>
<td>fq</td>
<td style="text-align:left">filter query。使用Filter Query可以充分利用Filter Query Cache，提高检索性能。作用：在q查询符合结果中同时是fq查询符合的，例如：q=mm&amp;fq=date_time:[20081001 TO 20091031]，找关键字mm，并且date_time是20081001到20091031之间的</td>
</tr>
<tr>
<td>fl</td>
<td style="text-align:left">field list。指定返回结果字段。以空格“ ”或逗号“,”分隔</td>
</tr>
<tr>
<td>start</td>
<td style="text-align:left">用于分页定义结果起始记录数，默认为0</td>
</tr>
<tr>
<td>rows</td>
<td style="text-align:left">用于分页定义结果每页返回记录数，默认为10</td>
</tr>
<tr>
<td>sort</td>
<td style="text-align:left">排序，格式: sort=&lt;field name&gt;+&lt;desc&#124;asc&gt;[,&lt;field name&gt;+&lt;desc&#124;asc&gt;]… 。示例：（inStock desc, price asc）表示先 “inStock” 降序, 再 “price” 升序，默认是相关性降序。</td>
</tr>
<tr>
<td>df</td>
<td style="text-align:left">默认的查询字段，一般默认指定</td>
</tr>
<tr>
<td>q.op</td>
<td style="text-align:left">覆盖schema.xml的defaultOperator（有空格时用”AND”还是用”OR”操作逻辑），一般默认指定。必须大写</td>
</tr>
<tr>
<td>wt</td>
<td style="text-align:left">writer type。指定查询输出结构格式，默认为“xml”。在solrconfig.xml中定义了查询输出格式：xml、json、python、ruby、php、phps、custom</td>
</tr>
<tr>
<td>qt</td>
<td style="text-align:left">query type，指定查询使用的Query Handler，默认为“standard”</td>
</tr>
<tr>
<td>explainOther</td>
<td style="text-align:left">设置当debugQuery=true时，显示其他的查询说明</td>
</tr>
<tr>
<td>defType</td>
<td style="text-align:left">指定用于处理查询语句(参数q的内容)的查询解析器，eg:defType=lucene</td>
</tr>
<tr>
<td>timeAllowed</td>
<td style="text-align:left">设置查询超时时间</td>
</tr>
<tr>
<td>omitHeader</td>
<td style="text-align:left">设置是否忽略查询结果返回头信息，默认为“false”</td>
</tr>
<tr>
<td>indent</td>
<td style="text-align:left">返回的结果是否缩进，默认关闭，用 indent=true&#124;on 开启，一般调试json,php,phps,ruby输出才有必要用这个参数</td>
</tr>
<tr>
<td>version</td>
<td style="text-align:left">查询语法的版本，建议不使用它，由服务器指定默认值</td>
</tr>
<tr>
<td>debugQuery</td>
<td style="text-align:left">设置返回结果是否显示Debug信息</td>
</tr>
</tbody>
</table>
<h3 id="查询语法"><a href="#查询语法" class="headerlink" title="查询语法"></a>查询语法</h3><ol>
<li><p>匹配所有文档：<em>:</em></p>
</li>
<li><p>强制、阻止和可选查询：<br> 1)Mandatory：查询结果中必须包括的(for example, only entry name containing the word make)<br> Solr/Lucene Statement：+make, +make +up ,+make +up +kiss<br> 2)prohibited：(for example, all documents except those with word believe)<br> Solr/Lucene Statement：+make +up -kiss<br> 3)optional：Solr/Lucene Statement：+make +up kiss</p>
</li>
<li><p>布尔操作：AND、OR和NOT布尔操作（必须大写）与Mandatory、optional和prohibited相似。<br> 1)make AND up ＝ +make +up :AND左右两边的操作都是mandatory<br> 2)make || up ＝ make OR up＝make up :OR左右两边的操作都是optional<br> 3)+make +up NOT kiss ＝ +make +up –kiss<br> 4)make AND up OR french AND Kiss不可以达到期望的结果，因为AND两边的操作都是mandatory的。</p>
</li>
<li><p>子表达式查询（子查询）：可以使用“()”构造子查询。<br> 示例：(make AND up) OR (french AND Kiss)</p>
</li>
<li><p>子表达式查询中阻止查询的限制：<br> 示例：make (-up):只能取得make的查询结果；要使用make (-up <em>:</em>)查询make或者不包括up的结果。</p>
</li>
<li><p>多字段fields查询：通过字段名加上分号的方式（fieldName:query）来进行查询<br> 示例：entryNm:make AND entryId:3cdc86e8e0fb4da8ab17caed42f6760c</p>
</li>
<li><p>通配符查询（wildCard Query）：<br> 1)通配符？和*：“*”表示匹配任意字符；“？”表示匹配出现的位置。<br> 示例：ma?*（ma后面的一个位置匹配），ma??*(ma后面两个位置都匹配)<br> 2)查询字符必须要小写:+Ma +be**可以搜索到结果；+Ma +Be**没有搜索结果.<br> 3)查询速度较慢，尤其是通配符在首位：主要原因一是需要迭代查询字段中的每个term，判断是否匹配；二是匹配上的term被加到内部的查询，当terms数量达到1024的时候，查询会失败。<br> 4)Solr中默认通配符不能出现在首位（可以修改QueryParser，设置setAllowLeadingWildcard为true）</p>
</li>
<li><p>模糊查询、相似查询：不是精确的查询，通过对查询的字段进行重新插入、删除和转换来取得得分较高的查询解决（由Levenstein Distance Algorithm算法支持）。<br> 1)一般模糊查询：示例：make-believ~<br> 2)门槛模糊查询：对模糊查询可以设置查询门槛，门槛是0~1之间的数值，门槛越高表面相似度越高。示例：make-believ~0.5、make-believ~0.8、make-believ~0.9</p>
</li>
<li><p>范围查询（Range Query）：Lucene支持对数字、日期甚至文本的范围查询。结束的范围可以使用“*”通配符。<br>示例：<br> 1)日期范围（ISO-8601 时间GMT）：sa_type:2 AND a_begin_date:[1990-01-01T00:00:00.000Z TO 1999-12-31T24:59:99.999Z]<br> 2)数字：salary:[2000 TO *]<br> 3)文本：entryNm:[a TO a]</p>
</li>
<li><p>日期匹配：YEAR, MONTH, DAY, DATE (synonymous with DAY) HOUR, MINUTE, SECOND, MILLISECOND, and MILLI (synonymous with MILLISECOND)可以被标志成日期。<br>示例：<br>1)r_event_date:[* TO NOW-2YEAR]：2年前的现在这个时间<br>2)r_event_date:[* TO NOW/DAY-2YEAR]：2年前前一天的这个时间</p>
</li>
<li><p>solr的查询语句支持C语言格式的注释。<br><code>&quot;jakarta apache&quot; /* this is a comment in the middle of a normal query string */ OR jakarta</code></p>
</li>
<li><p><code>+ - &amp;&amp; || ! ( ) { } [ ] ^ &quot; ~ * ? : /
这些字符在solr中具有特殊的含义，如果要使用这么字符本身含义，需要利用反斜杠进行转义，比如： \(1\+1\):2</code></p>
</li>
<li><p>solr的查询字符串q中的多个关键字之间默认的关系是 OR<br>例如：红旗 中国 ，代表：红旗 OR 中国</p>
</li>
<li><p>若要搜寻交集结果,请在词与词间加上大写 “AND” 或 “+” (不包含”号).<br>例如: text:总统府 AND text:邮局<br>或<br>+text:总统府 +text:邮局<br>或<br>name:总统府 AND tel:23xxxxxx3<br>或<br>name: ( +总统府 +邮局)</p>
</li>
<li><p>排除查询<br>在要排除的词前加上 “-” (不包含”号) 号<br>例如: 总统府 -邮局<br>搜寻结果不会有包含邮局的词的结果在内</p>
</li>
<li><p>增加权重: 如要搜寻 “中华 加油站”(不包含”号) 但因为回传太多笔资料内有 “中华”(不包含”号) 或 “加油站”(不包含”号) 的结果,<br>所以想要把有包含 “加油站”(不包含”号)的数据往前排,可使用 “^”(不包含”号)符号在后面加上愈增加的权重数,<br>像是 “2″,则可以这样做:<br>中华 加油站^2<br>会同时搜寻含有中华或加油站的结果,并把加油站这个词加权所以搜寻时会先判断加油站这一个词在<br>搜寻结果中的比重,甚至假设一笔数据内加油站出现过两次以上的就更加会有优先权.</p>
</li>
</ol>
<h3 id="标准查询操作符"><a href="#标准查询操作符" class="headerlink" title="标准查询操作符"></a>标准查询操作符</h3><table>
<thead>
<tr>
<th>参数</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:</code></td>
<td style="text-align:left">指定要查找的字段，比如：title:“The Right Way” AND text:go</td>
</tr>
<tr>
<td><code>？</code></td>
<td style="text-align:left">匹配单一字符，比如: te?t匹配test/text</td>
</tr>
<tr>
<td><code>*</code></td>
<td style="text-align:left">匹配0或多个字符，比如：tes*匹配test/testing/tester</td>
</tr>
<tr>
<td><code>~</code></td>
<td style="text-align:left">基于编辑距离的模糊查询，比如：roam~匹配roams/foam/foams/roam. roam~1(指定距离必须是1)匹配roams/foam，但不会匹配foams</td>
</tr>
<tr>
<td><code>~n</code></td>
<td style="text-align:left">邻近查询，查找相隔一定距离的单词，比如：”jakarta apache”~10（相隔10个单词）    （下面会详细说明<code>~</code> 和 <code>~n</code>的区别）</td>
</tr>
<tr>
<td><code>TO</code></td>
<td style="text-align:left">范围查询，{}不包含边界，[]包含边界，比如：title:{Aida TO Carmen}</td>
</tr>
<tr>
<td><code>^</code></td>
<td style="text-align:left">加权因子，比如:jakarta^4 apache 查找结果中jakarta更相关, 看下面相关度的说明</td>
</tr>
<tr>
<td><code>^=</code></td>
<td style="text-align:left">指定查询语句的score得分为常量，比如：(description:blue OR color:blue)^=1.0 text:shoes</td>
</tr>
<tr>
<td><code>AND(&amp;&amp;)</code></td>
<td style="text-align:left">运算符两边的查询词同时出现 比如：”jakarta apache” AND “Apache Lucene”</td>
</tr>
<tr>
<td><code>OR</code></td>
<td style="text-align:left">运算符两边的查询词至少一个出现, 默认运算符，比如 “jakarta apache” jakarta 等价于 “jakarta apache” OR jakarta</td>
</tr>
<tr>
<td><code>NOT(!)</code></td>
<td style="text-align:left">运算符后面的查询词不出现，比如”jakarta apache” NOT “Apache Lucene”</td>
</tr>
<tr>
<td><code>+</code></td>
<td style="text-align:left">运算符后面的查询词出现(known as the “required” operator),比如+jakarta lucene查询必须包含jakarta,而lucene可以出现可不出现</td>
</tr>
<tr>
<td><code>-</code></td>
<td style="text-align:left">不能包含运算符后面的查询词 “jakarta apache” -“Apache Lucene”</td>
</tr>
<tr>
<td><code>[]</code></td>
<td style="text-align:left">包含范围边界</td>
</tr>
<tr>
<td><code>{}</code></td>
<td style="text-align:left">不包含范围边界</td>
</tr>
</tbody>
</table>
<h3 id="模糊-编辑距离查询（对中文支持好像不太好，我在数字和英文上才测试成功）"><a href="#模糊-编辑距离查询（对中文支持好像不太好，我在数字和英文上才测试成功）" class="headerlink" title="模糊/编辑距离查询（对中文支持好像不太好，我在数字和英文上才测试成功）"></a>模糊/编辑距离查询（对中文支持好像不太好，我在数字和英文上才测试成功）</h3><p>对于很多搜索应用来说，很重要的功能是不仅仅需要精确匹配用户的文本内容。而且还允许一些灵活的变化，比如一些用户的拼写错误或相同单词的其它变体。Solr 通过基于 Damerau-Levenshtein 距离的编辑距离测量来支持这个功能，它将容忍 80% 以上的拼写错误。</p>
<h5 id="Solr-提供的模糊编辑距离查询需要用到波浪符号（-）："><a href="#Solr-提供的模糊编辑距离查询需要用到波浪符号（-）：" class="headerlink" title="Solr 提供的模糊编辑距离查询需要用到波浪符号（~）："></a>Solr 提供的模糊编辑距离查询需要用到波浪符号（~）：</h5><p>查询语句： administrator~ 匹配： adminstrator， administrater， administratior，等<br>这个查询不仅匹配原始的关键字（administrator），还有其它与原始关键字有 2 个编辑距离的关键字。一个编辑距离表示增加，删除，取代或交换一个任意字符。关键字 adminstrator （在第六个字母出少了字符“i”）和原始关键字之间相差一个编辑距离，因为它删除了一个字符。同样 sadministrator 和原始关键字之间也是相差一个编辑距离，因为它在前面添加了一个字符。administratro 也与原始关键字有一个编辑距离，因为它将最后两个字符交换了顺序。</p>
<h5 id="在编辑距离查询中也可以精确指定编辑距离："><a href="#在编辑距离查询中也可以精确指定编辑距离：" class="headerlink" title="在编辑距离查询中也可以精确指定编辑距离："></a>在编辑距离查询中也可以精确指定编辑距离：</h5><p>查询语句：administrator~1 匹配一个编辑距离以内的内容。<br>查询语句：administrator~2 匹配两个编辑距离以内的内容（如果没有提供编辑距离的话，这个就是默认值）。<br>查询语句：administrator~N 匹配 N 个编辑距离以内的内容。<br>注意，任何编辑距离大于 2 的查询将会使查询速度变得很慢。如果编辑距离在 2 以内，那么将会使用很高效率的 Levenshtein 自动机（Levenshtein automaton），但是如果编辑距离大于 2，将会退回到更慢的编辑距离实现。</p>
<h3 id="临近查询"><a href="#临近查询" class="headerlink" title="临近查询"></a>临近查询</h3><p>在前面，我们看到了编辑距离查询是如何查找相似的关键字，而不是进行精确匹配。编辑距离的概念适用于关键字中字符的变换或短语中各个单词之间的变化。</p>
<p>如果你想要通过 Solr 的索引查询公司中所有员工的档案。一种方法是枚举出公司中所有可能的职位：</p>
<p>查询语句：”chief executive officer” OR “chief financial officer” OR “chief marketing officer” OR “chief technology officer” OR …</p>
<p>当然，这种查询的前提是你需要知道公司中所有可能的职位，这当然不现实。另外的一种解决方案是单独搜索每个关键字：</p>
<p>查询语句： chief AND officer<br>这将会匹配所有可能的用例，但是同时也会匹配所有包含了这两个关键字的文档。例如：One chief concern arising from the incident was the safety of the police officer on duty。这个文档明显不符合我们的要求，但是如果使用上面的查询语句，那么将会返回这个文档。</p>
<p>Solr 提供了解决这种问题的方案：临近查询。在上面的例子中，比较好的策略是请求 Solr 返回所有包含了关键字 chief 和关键字 officer 临近的文档。这可以通过下面的查询语句样例来实现：</p>
<p>查询语句： “chief officer”~1<br>解释：chief 和 officer 之间最多只能有一个距离<br>例子：”chief executive officer”, “chief financial officer”</p>
<p>查询语句：”chief officer”~2<br>解释：chief 和 officer 之间最多只能有两个编辑距离<br>例子：”chief business development officer”, “officer chief”</p>
<p>查询语句：”chief officer”~N<br>解释：查询 chief 和 officer 之间有 N 个编辑距离。</p>
<p>事实上，对短语进行精确匹配的查询语句 “chief  development  officer” 很容易改写成  “chief development officer”~0。这两个查询都返回相同的结果，因为在第二个查询语句中，编辑距离设置为 0，所以和精确查询得到的结果是相同的。这两种机制都需要使用到 Solr 中存储的关键字位置（前面的文章介绍过）来计算编辑距离。还有一点需要注意的是，临近查询并不是完全按照编辑距离的定义来进行查询，因为它的查询结果中，所有的关键字都必须存在。而编辑距离查询的定义中，可以对关键字进行删除和修改。</p>
<p>但是其它的编辑距离定义依旧保留，例如增加和换位。顺着这条线，你可能会注意到，你需要设置 2 进行临近查询的时候（”chief officer”~2）才能查询出文本 officer chief。这是因为第一次编辑将 chief 和 officer 修改成相同的位置；第二次编辑将 chief 才能将 chief 编辑到 officer 后面。这也再次说明了临近查询使用的并不是真正的编辑距离（在编辑距离中，位置互换的编辑距离只能算 1）。</p>
<h3 id="模糊-编辑距离查询-和-临近查询-的区别"><a href="#模糊-编辑距离查询-和-临近查询-的区别" class="headerlink" title="模糊/编辑距离查询 和 临近查询 的区别"></a>模糊/编辑距离查询 和 临近查询 的区别</h3><ol>
<li>模糊/编辑距离查询 是对一个字符串进行查询；</li>
<li>临近查询 是对两个字符串进行查询，并且它们被”包围着</li>
</ol>
<h3 id="Solr文本匹配不同字段的相关度权重设置需要做如下设置："><a href="#Solr文本匹配不同字段的相关度权重设置需要做如下设置：" class="headerlink" title="Solr文本匹配不同字段的相关度权重设置需要做如下设置："></a>Solr文本匹配不同字段的相关度权重设置需要做如下设置：</h3><p>1）启用edismax选项，在检索url上添加defType=edismax参数<br>2）设置q参数为搜索关键词，这里不要再写搜索表达式了<br>3）设置qf参数，指定不同字段的权重，例如：title^10 keywords^10 content^1 表示title字段的权重设置为10，keywords为10，content权重设置为1 </p>
<hr>
<h3 id="solr删除数据的快捷方式"><a href="#solr删除数据的快捷方式" class="headerlink" title="solr删除数据的快捷方式"></a>solr删除数据的快捷方式</h3><p>在solr的WEB客户端，访问你的索引库<br>1)documents type 选择 XML<br>2)documents 输入下面语句<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">delete</span>&gt;</span><span class="tag">&lt;<span class="name">query</span>&gt;</span>*:*<span class="tag">&lt;/<span class="name">query</span>&gt;</span><span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">commit</span>/&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>点击<code>Submit Document</code>即可</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/hewentian/2017/10/29/solr-note/" data-id="cjcpkyc9v0014y02i9n3ox8uf" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/solr/">solr</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-solr-commit-types" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/10/29/solr-commit-types/" class="article-date">
  <time datetime="2017-10-29T02:59:11.000Z" itemprop="datePublished">2017-10-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/bigdata/">bigdata</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/10/29/solr-commit-types/">solr提交索引的三种方式</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="1-commit"><a href="#1-commit" class="headerlink" title="1.commit"></a>1.commit</h2><p>通过api直接commit,这样性能比较差</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.solr.client.solrj.SolrServerException;</span><br><span class="line"><span class="keyword">import</span> org.apache.solr.client.solrj.impl.HttpSolrClient;</span><br><span class="line"><span class="keyword">import</span> org.apache.solr.common.SolrInputDocument;</span><br><span class="line"></span><br><span class="line">String baseSolrUrl = <span class="string">"http://localhost:8983/solr/"</span>;</span><br><span class="line">HttpSolrClient solrClient = <span class="keyword">new</span> HttpSolrClient.Builder().withBaseSolrUrl(baseSolrUrl).build();</span><br><span class="line"></span><br><span class="line">SolrInputDocument solrInputDocument = <span class="keyword">new</span> SolrInputDocument();</span><br><span class="line">solrInputDocument.addField(<span class="string">"id"</span>, <span class="string">"1"</span>);</span><br><span class="line">solrInputDocument.addField(<span class="string">"name"</span>, <span class="string">"Tim Ho"</span>);</span><br><span class="line">solrInputDocument.addField(<span class="string">"age"</span>, <span class="string">"23"</span>);</span><br><span class="line"></span><br><span class="line">solrClient.add(<span class="string">"mysqlCore"</span>, solrInputDocument);</span><br><span class="line">solrClient.commit();</span><br></pre></td></tr></table></figure>
<h2 id="2-commitWithinMs"><a href="#2-commitWithinMs" class="headerlink" title="2.commitWithinMs"></a>2.commitWithinMs</h2><p>简单的说就是告诉solr在多少毫秒内提交，比如我指定commitWithinMs=10000，将会告诉solr在10s内提交我的document。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">用法：</span><br><span class="line"><span class="number">1</span>.可以在add方法设置参数，比如：solrClient.add(<span class="string">"mysqlCore"</span>, solrInputDocument, <span class="number">10000</span>);</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>.UpdateRequest updateRequest = <span class="keyword">new</span> UpdateRequest();</span><br><span class="line">  updateRequest.add(solrInputDocument);</span><br><span class="line">  updateRequest.setCommitWithin(<span class="number">10000</span>);</span><br><span class="line">  updateRequest.process(solrClient, <span class="string">"mysqlCore"</span>);</span><br></pre></td></tr></table></figure></p>
<p>参考：<a href="https://lucene.apache.org/solr/guide/6_6/updatehandlers-in-solrconfig.html" target="_blank" rel="noopener">https://lucene.apache.org/solr/guide/6_6/updatehandlers-in-solrconfig.html</a></p>
<h2 id="3-AutoCommit"><a href="#3-AutoCommit" class="headerlink" title="3.AutoCommit"></a>3.AutoCommit</h2><p>参考：<a href="http://wiki.apache.org/solr/SolrConfigXml" target="_blank" rel="noopener">http://wiki.apache.org/solr/SolrConfigXml</a><br>例如，我的配置文件在 /home/hewentian/ProjectD/solr-6.5.0/server/solr/mysqlCore/conf/solrconfig.xml 中已有默认配置，如下：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- The default high-performance update handler --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">updateHandler</span> <span class="attr">class</span>=<span class="string">"solr.DirectUpdateHandler2"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Enables a transaction log, used for real-time get, durability, and</span></span><br><span class="line"><span class="comment">         and solr cloud replica recovery.  The log can grow as big as</span></span><br><span class="line"><span class="comment">         uncommitted changes to the index, so use of a hard autoCommit</span></span><br><span class="line"><span class="comment">         is recommended (see below).</span></span><br><span class="line"><span class="comment">         "dir" - the target directory for transaction logs, defaults to the</span></span><br><span class="line"><span class="comment">                solr data directory.</span></span><br><span class="line"><span class="comment">         "numVersionBuckets" - sets the number of buckets used to keep</span></span><br><span class="line"><span class="comment">                track of max version values when checking for re-ordered</span></span><br><span class="line"><span class="comment">                updates; increase this value to reduce the cost of</span></span><br><span class="line"><span class="comment">                synchronizing access to version buckets during high-volume</span></span><br><span class="line"><span class="comment">                indexing, this requires 8 bytes (long) * numVersionBuckets</span></span><br><span class="line"><span class="comment">                of heap space per Solr core.</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">updateLog</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">str</span> <span class="attr">name</span>=<span class="string">"dir"</span>&gt;</span>$&#123;solr.ulog.dir:&#125;<span class="tag">&lt;/<span class="name">str</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">int</span> <span class="attr">name</span>=<span class="string">"numVersionBuckets"</span>&gt;</span>$&#123;solr.ulog.numVersionBuckets:65536&#125;<span class="tag">&lt;/<span class="name">int</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">updateLog</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- AutoCommit</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">         Perform a hard commit automatically under certain conditions.</span></span><br><span class="line"><span class="comment">         Instead of enabling autoCommit, consider using "commitWithin"</span></span><br><span class="line"><span class="comment">         when adding documents. </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">         http://wiki.apache.org/solr/UpdateXmlMessages</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">         maxDocs - Maximum number of documents to add since the last</span></span><br><span class="line"><span class="comment">                   commit before automatically triggering a new commit.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">         maxTime - Maximum amount of time in ms that is allowed to pass</span></span><br><span class="line"><span class="comment">                   since a document was added before automatically</span></span><br><span class="line"><span class="comment">                   triggering a new commit. </span></span><br><span class="line"><span class="comment">         openSearcher - if false, the commit causes recent index changes</span></span><br><span class="line"><span class="comment">           to be flushed to stable storage, but does not cause a new</span></span><br><span class="line"><span class="comment">           searcher to be opened to make those changes visible.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">         If the updateLog is enabled, then it's highly recommended to</span></span><br><span class="line"><span class="comment">         have some sort of hard autoCommit to limit the log size.</span></span><br><span class="line"><span class="comment">      --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">autoCommit</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">maxTime</span>&gt;</span>$&#123;solr.autoCommit.maxTime:15000&#125;<span class="tag">&lt;/<span class="name">maxTime</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">openSearcher</span>&gt;</span>false<span class="tag">&lt;/<span class="name">openSearcher</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">autoCommit</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- softAutoCommit is like autoCommit except it causes a</span></span><br><span class="line"><span class="comment">         'soft' commit which only ensures that changes are visible</span></span><br><span class="line"><span class="comment">         but does not ensure that data is synced to disk.  This is</span></span><br><span class="line"><span class="comment">         faster and more near-realtime friendly than a hard commit.</span></span><br><span class="line"><span class="comment">      --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">autoSoftCommit</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">maxTime</span>&gt;</span>$&#123;solr.autoSoftCommit.maxTime:-1&#125;<span class="tag">&lt;/<span class="name">maxTime</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">autoSoftCommit</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Update Related Event Listeners</span></span><br><span class="line"><span class="comment">         </span></span><br><span class="line"><span class="comment">         Various IndexWriter related events can trigger Listeners to</span></span><br><span class="line"><span class="comment">         take actions.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">         postCommit - fired after every commit or optimize command</span></span><br><span class="line"><span class="comment">         postOptimize - fired after every optimize command</span></span><br><span class="line"><span class="comment">      --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- The RunExecutableListener executes an external command from a</span></span><br><span class="line"><span class="comment">         hook such as postCommit or postOptimize.</span></span><br><span class="line"><span class="comment">         </span></span><br><span class="line"><span class="comment">         exe - the name of the executable to run</span></span><br><span class="line"><span class="comment">         dir - dir to use as the current working directory. (default=".")</span></span><br><span class="line"><span class="comment">         wait - the calling thread waits until the executable returns. </span></span><br><span class="line"><span class="comment">                (default="true")</span></span><br><span class="line"><span class="comment">         args - the arguments to pass to the program.  (default is none)</span></span><br><span class="line"><span class="comment">         env - environment variables to set.  (default is none)</span></span><br><span class="line"><span class="comment">      --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- This example shows how RunExecutableListener could be used</span></span><br><span class="line"><span class="comment">         with the script based replication...</span></span><br><span class="line"><span class="comment">         http://wiki.apache.org/solr/CollectionDistribution</span></span><br><span class="line"><span class="comment">      --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">       &lt;listener event="postCommit" class="solr.RunExecutableListener"&gt;</span></span><br><span class="line"><span class="comment">         &lt;str name="exe"&gt;solr/bin/snapshooter&lt;/str&gt;</span></span><br><span class="line"><span class="comment">         &lt;str name="dir"&gt;.&lt;/str&gt;</span></span><br><span class="line"><span class="comment">         &lt;bool name="wait"&gt;true&lt;/bool&gt;</span></span><br><span class="line"><span class="comment">         &lt;arr name="args"&gt; &lt;str&gt;arg1&lt;/str&gt; &lt;str&gt;arg2&lt;/str&gt; &lt;/arr&gt;</span></span><br><span class="line"><span class="comment">         &lt;arr name="env"&gt; &lt;str&gt;MYVAR=val1&lt;/str&gt; &lt;/arr&gt;</span></span><br><span class="line"><span class="comment">       &lt;/listener&gt;</span></span><br><span class="line"><span class="comment">      --&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;/<span class="name">updateHandler</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="1-硬提交是提交数据持久化到磁盘里面。不过，比较耗费机器资源，这样即使jvm崩溃或者宕机，也不影响这部分索引。"><a href="#1-硬提交是提交数据持久化到磁盘里面。不过，比较耗费机器资源，这样即使jvm崩溃或者宕机，也不影响这部分索引。" class="headerlink" title="1.硬提交是提交数据持久化到磁盘里面。不过，比较耗费机器资源，这样即使jvm崩溃或者宕机，也不影响这部分索引。"></a>1.硬提交是提交数据持久化到磁盘里面。不过，比较耗费机器资源，这样即使jvm崩溃或者宕机，也不影响这部分索引。</h3><p>openSearcher: true  索引在searcher中可见, 但是也需要重新打开searcher才行。<br>openSearcher: false 索引在searcher中不可见。</p>
<p>按照下面的配置就会使用solr的自动硬提交功能，就不用我们自己手动提交。<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">autoCommit</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--表示软提交达到1万条的时候会自动进行一次硬提交--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">maxDocs</span>&gt;</span>10000<span class="tag">&lt;/<span class="name">maxDocs</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--表示软提交10秒之后会执行一次硬提交--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">maxTime</span>&gt;</span>10000<span class="tag">&lt;/<span class="name">maxTime</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--true表示每一次硬提交都开启一个新的Searcher--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">openSearcher</span>&gt;</span>false<span class="tag">&lt;/<span class="name">openSearcher</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">autoCommit</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="2-软提交是提交数据到内存里面，并没有持久化到磁盘，但是他会把提交的记录写到tlog的日志文件里面所以如果jvm崩溃，那这部分索引就没了"><a href="#2-软提交是提交数据到内存里面，并没有持久化到磁盘，但是他会把提交的记录写到tlog的日志文件里面所以如果jvm崩溃，那这部分索引就没了" class="headerlink" title="2.软提交是提交数据到内存里面，并没有持久化到磁盘，但是他会把提交的记录写到tlog的日志文件里面所以如果jvm崩溃，那这部分索引就没了"></a>2.软提交是提交数据到内存里面，并没有持久化到磁盘，但是他会把提交的记录写到tlog的日志文件里面所以如果jvm崩溃，那这部分索引就没了</h3><p>下面就是自动软提交的配置，不需要自己维护提交（默认没有开启）：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">autoSoftCommit</span>&gt;</span> </span><br><span class="line">  <span class="comment">&lt;!--5秒执行一次软提交--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">maxTime</span>&gt;</span>5000<span class="tag">&lt;/<span class="name">maxTime</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">autoSoftCommit</span>&gt;</span></span><br></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/hewentian/2017/10/29/solr-commit-types/" data-id="cjcpkyc9d000ty02i9cra1gjb" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/solr/">solr</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-solr-install" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/10/28/solr-install/" class="article-date">
  <time datetime="2017-10-28T02:57:27.000Z" itemprop="datePublished">2017-10-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/bigdata/">bigdata</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/10/28/solr-install/">solr的安装使用</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>下面说说我的solr学习笔记之 solr6.5.0 + jetty + mysql 使用 DIH 搭建 solr 服务</p>
<p>参考：<a href="https://wiki.apache.org/solr/DIHQuickStart" target="_blank" rel="noopener">https://wiki.apache.org/solr/DIHQuickStart</a></p>
<p>首先下载solr，下载地址为：<a href="http://lucene.apache.org/solr/" target="_blank" rel="noopener">http://lucene.apache.org/solr/</a></p>
<p>截至写该笔记时，solr的版本为6.5.0，下载<code>solr-6.5.0.tgz</code>后，将其解压到任意一个目录。当然，目录路径不要有中文。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cd /home/hewentian/ProjectD</span></span><br><span class="line">$ tar xzvf solr-6.5.0.tgz</span><br></pre></td></tr></table></figure></p>
<p>我解压到<code>/home/hewentian/ProjectD/solr-6.5.0</code>，目录结构如下：<br>bin<br>contrib<br>dist<br>docs<br>example<br>licenses<br>server<br>CHANGES.txt<br>LICENSE.txt<br>LUCENE_CHANGES.txt<br>NOTICE.txt<br>README.txt</p>
<p>solr的软件包，默认使用jetty部署，SOLR6要求JDK8，启动solr的命令很简单：<br>在DOS窗口中命令如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ /home/hewentian/ProjectD/solr-6.5.0/bin/solr start</span><br></pre></td></tr></table></figure></p>
<p>然后在浏览器中可以访问：<br><a href="http://localhost:8983/solr" target="_blank" rel="noopener">http://localhost:8983/solr</a></p>
<p>在server/solr目录下，有一个README.txt的文件，其中说明了如何建立solr core。<br>最简单的建立是直接复制solr中为我们提供好的例子，打开<code>server/solr/configsets</code>目录会发现里面已经有三个例子，如下：<br>basic_configs<br>data_driven_schema_configs<br>sample_techproducts_configs</p>
<p>因为我们是要从数据库导入数据，所以选择以 “data_driven_schema_configs” 这个例子为模板创建我们的core: mysqlCore。<br>在DOS窗口中命令如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ /home/hewentian/ProjectD/solr-6.5.0/bin/solr create -c mysqlCore -d data_driven_schema_configs</span><br></pre></td></tr></table></figure></p>
<p>说明：<br>-c: 指定创建的core为mysqlCore<br>-d：指定以data_driven_schema_configs为模板</p>
<p>执行上面的命令后在<code>/home/hewentian/ProjectD/solr-6.5.0/server/solr</code>目录下会有一个文件夹mysqlCore</p>
<p>然后在浏览器中可以访问：<br><a href="http://localhost:8983/solr" target="_blank" rel="noopener">http://localhost:8983/solr</a></p>
<p>你会在[Core Selector]中看到mysqlCore，但是目前还不能使用DIH导入数据，需下面的设置。</p>
<p>建数据表，并插入3条记录，如下：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> <span class="comment">/*!32312 IF NOT EXISTS*/</span><span class="string">`test`</span> <span class="comment">/*!40100 DEFAULT CHARACTER SET utf8 */</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">USE</span> <span class="string">`test`</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*Table structure for table `user` */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> <span class="string">`user`</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`user`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'用户id'</span>,</span><br><span class="line">  <span class="string">`name_`</span> <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'名字'</span>,</span><br><span class="line">  <span class="string">`age_`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'年龄'</span>,</span><br><span class="line">  <span class="string">`ability_`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'资格；等级'</span>,</span><br><span class="line">  <span class="string">`address_`</span> <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'详细地址'</span>,</span><br><span class="line">  <span class="string">`school1_`</span> <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'学校1'</span>,</span><br><span class="line">  <span class="string">`school2_`</span> <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'学校2'</span>,</span><br><span class="line">  <span class="string">`school3_`</span> <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'学校3'</span>,</span><br><span class="line">  <span class="string">`update_time_`</span> <span class="keyword">timestamp</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">CURRENT_TIMESTAMP</span> <span class="keyword">COMMENT</span> <span class="string">'更新时间'</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8 <span class="keyword">COMMENT</span>=<span class="string">'用户表'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*Data for the table `user` */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span>  <span class="keyword">into</span> <span class="string">`user`</span>(<span class="string">`id`</span>,<span class="string">`name_`</span>,<span class="string">`age_`</span>,<span class="string">`ability_`</span>,<span class="string">`address_`</span>,<span class="string">`school1_`</span>,<span class="string">`school2_`</span>,<span class="string">`school3_`</span>,<span class="string">`update_time_`</span>) </span><br><span class="line"><span class="keyword">values</span> </span><br><span class="line">(<span class="string">'1'</span>,<span class="string">'张三'</span>,<span class="number">20</span>,<span class="string">'初级工程师'</span>,<span class="string">'广东'</span>,<span class="literal">NULL</span>,<span class="literal">NULL</span>,<span class="literal">NULL</span>,<span class="string">'2017-10-28 11:39:52'</span>),</span><br><span class="line">(<span class="string">'2'</span>,<span class="string">'李四'</span>,<span class="number">20</span>,<span class="string">'中级工程师'</span>,<span class="string">'湖南'</span>,<span class="string">'湖南实验小学'</span>,<span class="literal">NULL</span>,<span class="string">'湖南大学'</span>,<span class="string">'2017-10-28 11:39:51'</span>),</span><br><span class="line">(<span class="string">'3'</span>,<span class="string">'王五'</span>,<span class="number">40</span>,<span class="string">'高级工程师'</span>,<span class="string">'北京'</span>,<span class="string">'北京实验小学'</span>,<span class="string">'北京第一中学'</span>,<span class="string">'北京大学'</span>,<span class="string">'2017-10-28 11:39:53'</span>);</span><br></pre></td></tr></table></figure></p>
<p>为了使用mysql导入数据，我们还需要导入两个重要的jar包。由于mysql的jar包并没有在项目中，于是我复制了一份<br>放到了<code>server/lib/ext</code>目录下面了。我加的是mysql-connector-java-5.1.25.jar，如果你的是另外的版本，要修改下<br>面的lib中正则的部分。另外两个需要的jar包就是dist目录下带有“dataimport”标识的jar包。<br>然后打开mysqlCore/conf/solrconfig.xml，引用上面提到的jar包，如下。<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">lib</span> <span class="attr">dir</span>=<span class="string">"$&#123;solr.install.dir:../../../..&#125;/contrib/extraction/lib"</span> <span class="attr">regex</span>=<span class="string">".*\.jar"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">lib</span> <span class="attr">dir</span>=<span class="string">"$&#123;solr.install.dir:../../../..&#125;/dist/"</span> <span class="attr">regex</span>=<span class="string">"solr-cell-\d.*\.jar"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">lib</span> <span class="attr">dir</span>=<span class="string">"$&#123;solr.install.dir:../../../..&#125;/contrib/clustering/lib/"</span> <span class="attr">regex</span>=<span class="string">".*\.jar"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">lib</span> <span class="attr">dir</span>=<span class="string">"$&#123;solr.install.dir:../../../..&#125;/dist/"</span> <span class="attr">regex</span>=<span class="string">"solr-clustering-\d.*\.jar"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">lib</span> <span class="attr">dir</span>=<span class="string">"$&#123;solr.install.dir:../../../..&#125;/contrib/langid/lib/"</span> <span class="attr">regex</span>=<span class="string">".*\.jar"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">lib</span> <span class="attr">dir</span>=<span class="string">"$&#123;solr.install.dir:../../../..&#125;/dist/"</span> <span class="attr">regex</span>=<span class="string">"solr-langid-\d.*\.jar"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">lib</span> <span class="attr">dir</span>=<span class="string">"$&#123;solr.install.dir:../../../..&#125;/contrib/velocity/lib"</span> <span class="attr">regex</span>=<span class="string">".*\.jar"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">lib</span> <span class="attr">dir</span>=<span class="string">"$&#123;solr.install.dir:../../../..&#125;/dist/"</span> <span class="attr">regex</span>=<span class="string">"solr-velocity-\d.*\.jar"</span> /&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="comment">&lt;!-- 上面的lib为原本有的，下面的lib为添加的 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">lib</span> <span class="attr">dir</span>=<span class="string">"$&#123;solr.install.dir:../../../..&#125;/dist/"</span> <span class="attr">regex</span>=<span class="string">"solr-dataimporthandler-.*\.jar"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">lib</span> <span class="attr">dir</span>=<span class="string">"$&#123;solr.install.dir:../../../..&#125;/server/lib/ext/"</span> <span class="attr">regex</span>=<span class="string">"mysql-connector-java-5.1.25.jar"</span> /&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>添加requestHandler<br>在mysqlCore/conf/solrconfig.xml，搜索<code>&lt;requestHandler name=&quot;/select&quot; class=&quot;solr.SearchHandler&quot;&gt;</code><br>然后在该行之上添加如下代码。<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">requestHandler</span> <span class="attr">name</span>=<span class="string">"/dataimport"</span> <span class="attr">class</span>=<span class="string">"solr.DataImportHandler"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">lst</span> <span class="attr">name</span>=<span class="string">"defaults"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">str</span> <span class="attr">name</span>=<span class="string">"config"</span>&gt;</span>db-data-config.xml<span class="tag">&lt;/<span class="name">str</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">lst</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">requestHandler</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>在mysqlCore/conf目录下新建db-data-config.xml, 内容如下。<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dataConfig</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">name</span>=<span class="string">"ds"</span> <span class="attr">type</span>=<span class="string">"JdbcDataSource"</span> <span class="attr">driver</span>=<span class="string">"com.mysql.jdbc.Driver"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">url</span>=<span class="string">"jdbc:mysql://localhost:3306/test"</span> <span class="attr">user</span>=<span class="string">"root"</span> <span class="attr">password</span>=<span class="string">"root"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">document</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">entity</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">pk</span>=<span class="string">"id"</span> <span class="attr">dataSource</span>=<span class="string">"ds"</span> <span class="attr">query</span>=<span class="string">"select * from user"</span></span></span><br><span class="line"><span class="tag">			<span class="attr">deltaQuery</span>=<span class="string">"select id from user where update_time_&gt;'$&#123;dataimporter.last_index_time&#125;'"</span></span></span><br><span class="line"><span class="tag">			<span class="attr">deltaImportQuery</span>=<span class="string">"select t.* from user t where t.id='$&#123;dataimporter.delta.id&#125;'"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span> /&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">column</span>=<span class="string">"name_"</span> /&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"age"</span> <span class="attr">column</span>=<span class="string">"age_"</span> /&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"ability"</span> <span class="attr">column</span>=<span class="string">"ability_"</span> /&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"address"</span> <span class="attr">column</span>=<span class="string">"address_"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">			<span class="comment">&lt;!-- 将DB中的多个列，在solr中以数组形式存储到一个field中 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"schools"</span> <span class="attr">column</span>=<span class="string">"school1_"</span> /&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"schools"</span> <span class="attr">column</span>=<span class="string">"school2_"</span> /&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"schools"</span> <span class="attr">column</span>=<span class="string">"school3_"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">			<span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"update_time"</span> <span class="attr">column</span>=<span class="string">"update_time_"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">entity</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">document</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dataConfig</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>说明：<br>    dataSource是数据库数据源。Entity就是一张表对应的实体，pk是主键，query是查询语句。<br>    Field对应一个字段，column是数据库里的column名，后面的name属性对应着Solr的Filed的名字。<br>    其中test是数据库名，user是表名。</p>
<p>在mysqlCore/conf/managed-schema配置field信息，其中id的field本身已有。默认的 filed 不要删。<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">type</span>=<span class="string">"string"</span> <span class="attr">indexed</span>=<span class="string">"true"</span> <span class="attr">stored</span>=<span class="string">"true"</span> <span class="attr">required</span>=<span class="string">"true"</span> <span class="attr">multiValued</span>=<span class="string">"false"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">type</span>=<span class="string">"string"</span> <span class="attr">indexed</span>=<span class="string">"true"</span> <span class="attr">stored</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"age"</span> <span class="attr">type</span>=<span class="string">"int"</span> <span class="attr">indexed</span>=<span class="string">"true"</span> <span class="attr">stored</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"ability"</span> <span class="attr">type</span>=<span class="string">"string"</span> <span class="attr">indexed</span>=<span class="string">"true"</span> <span class="attr">stored</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"address"</span> <span class="attr">type</span>=<span class="string">"string"</span> <span class="attr">indexed</span>=<span class="string">"true"</span> <span class="attr">stored</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"schools"</span> <span class="attr">type</span>=<span class="string">"text_general"</span> <span class="attr">multiValued</span>=<span class="string">"true"</span> <span class="attr">indexed</span>=<span class="string">"true"</span> <span class="attr">stored</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"update_time"</span> <span class="attr">type</span>=<span class="string">"date"</span> <span class="attr">multiValued</span>=<span class="string">"false"</span> <span class="attr">indexed</span>=<span class="string">"true"</span> <span class="attr">stored</span>=<span class="string">"true"</span>/&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>由于修改了配置文件，所以要重启solr，命令如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ /home/hewentian/ProjectD/solr-6.5.0/bin/solr stop -all</span><br><span class="line">$ /home/hewentian/ProjectD/solr-6.5.0/bin/solr start</span><br></pre></td></tr></table></figure></p>
<p>然后在浏览器中可以访问：<br><a href="http://localhost:8983/solr" target="_blank" rel="noopener">http://localhost:8983/solr</a></p>
<p>点击[Core Selector]-&gt;mysqlCore-&gt;Dataimport在新的页面中按如下选择：<br>Command: full-import<br>Entity:user<br>Auto-Refresh Status<br>然后点[Execute]</p>
<p>成功后，点[Query]即可查询。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/hewentian/2017/10/28/solr-install/" data-id="cjcpkyc9r0010y02i6eahv6ie" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/solr/">solr</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-git-note" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/10/17/git-note/" class="article-date">
  <time datetime="2017-10-17T02:17:07.000Z" itemprop="datePublished">2017-10-17</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/other/">other</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/10/17/git-note/">git常用操作</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="下面记录一些经常会用到的命令："><a href="#下面记录一些经常会用到的命令：" class="headerlink" title="下面记录一些经常会用到的命令："></a>下面记录一些经常会用到的命令：</h2><p>查看远程分支, 加上 -a 参数可以查看远程分支，远程分支会用红色表示出来（如果你开了颜色支持的话），不加 -a 则查看本地分支：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ git branch -a</span><br><span class="line">  dev</span><br><span class="line">* master</span><br><span class="line">  remotes/origin/HEAD -&gt; origin/master</span><br><span class="line">  remotes/origin/master</span><br><span class="line">  remotes/origin/prod</span><br></pre></td></tr></table></figure></p>
<p>删除远程分支和tag, 在Git v1.7.0 之后，可以使用这种语法删除远程分支：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git push origin --delete &lt;branchName&gt;</span><br></pre></td></tr></table></figure></p>
<p>删除tag这么用：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git push origin --delete tag &lt;tagname&gt;</span><br></pre></td></tr></table></figure></p>
<p>否则，可以使用这种语法，推送一个空分支到远程分支，其实就相当于删除远程分支：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git push origin :&lt;branchName&gt;</span><br></pre></td></tr></table></figure></p>
<p>这是删除tag的方法，推送一个空tag到远程tag：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git tag -d &lt;tagname&gt;</span><br><span class="line">$ git push origin :refs/tags/&lt;tagname&gt;</span><br></pre></td></tr></table></figure></p>
<p>两种语法作用完全相同。</p>
<p>将远程git仓库里的指定分支拉取到本地（本地不存在的分支）<br>当我想从远程仓库里拉取一条本地不存在的分支时：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git checkout -b 本地分支名 origin/远程分支名</span><br></pre></td></tr></table></figure></p>
<p>这个将会自动创建一个新的本地分支，并与指定的远程分支关联起来。</p>
<p>例如远程仓库里有个分支dev2,我本地没有该分支，我要把dev2拉到我本地：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git checkout -b dev2 origin/dev2</span><br></pre></td></tr></table></figure></p>
<p>若成功，将会在本地创建新分支dev2,并自动切到dev2上。<br>如果出现提示：</p>
<pre><code>fatal: Cannot update paths and switch to branch &apos;dev2&apos; at the same time.
Did you intend to checkout &apos;origin/dev2&apos; which can not be resolved as commit?
</code></pre><p>表示拉取不成功。我们需要先执行<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git fetch</span><br></pre></td></tr></table></figure></p>
<p>然后再执行下面的命令即可<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git checkout -b 本地分支名 origin/远程分支名</span><br></pre></td></tr></table></figure></p>
<p>Git 比较不同版本文件差异的常用命令格式：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ git diff	查看尚未暂存的文件中更新了哪些部分</span><br><span class="line">$ git diff filename	查看尚未暂存的某个文件更新了哪些部分</span><br><span class="line">$ git diff –cached	查看已经暂存起来的文件中和上次提交的版本之间的差异</span><br><span class="line">$ git diff –cached filename	查看已经暂存起来的某个文件和上次提交的版本之间的差异</span><br><span class="line">$ git diff &lt;commitId1&gt; &lt;commitId2&gt;	查看某两个版本之间的差异</span><br><span class="line">$ git diff &lt;commitId1&gt;:filename &lt;commitId2&gt;:filename	查看某两个版本的某个文件之间的差异，方式一</span><br><span class="line">$ git diff &lt;commitId1&gt; &lt;commitId2&gt; -- filename	查看某两个版本的某个文件之间的差异，方式二</span><br></pre></td></tr></table></figure></p>
<p>在git中查看历史的命令主要是git log，要查看某个文件的修改历史：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">log</span> -- begin.txt</span><br></pre></td></tr></table></figure></p>
<p>可以添加不同的选项让输出的内容或格式有所不同。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">log</span> -p -- begin.txt</span><br></pre></td></tr></table></figure></p>
<p>-p 选项可以输出每次提交中的diff， -p会把输出搞得很长、很乱，不容易找到重点。<br>还有另外一种方式是：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">log</span> --pretty=oneline -- filename</span><br></pre></td></tr></table></figure></p>
<p>在log 命令中加入 –pretty=oneline 选项只能看到comments，看不到提交的用户和日期。<br>这也能够让我们集中注意力快速找到关注的提交记录。</p>
<p>然后使用 git show命令查看完整的提交内容。</p>
<p>当然，除了命令行工具您也可以使用GUI程序查看文件的历史记录：<br>gitk filename</p>
<p>查看历史中的文件内容</p>
<p>当我们使用 git log 命令找到了某次提交，并且想看看这次提交时文件的完整内容。<br>这时，我们需要使用 git show 命令：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git show &lt;commitId&gt;:filename</span><br></pre></td></tr></table></figure></p>
<p>也许此时你并不是看看就算了，你想要使用这个版本的文件更新工作区中的文件。<br>直接从 git show 命令的输出中拷贝内容是个不错的选择。<br>但也可以通过组合使用不同的命令来实现：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git checkout &lt;commitId&gt; --filename</span><br><span class="line">$ git reset filename</span><br></pre></td></tr></table></figure></p>
<p>此时只有工作区被更新了(你也可以把他当做是一次回滚操作)。</p>
<h3 id="git-将单个文件恢复到历史版本的正确方法如下："><a href="#git-将单个文件恢复到历史版本的正确方法如下：" class="headerlink" title="git 将单个文件恢复到历史版本的正确方法如下："></a>git 将单个文件恢复到历史版本的正确方法如下：</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">log</span> 要恢复的文件路径</span><br><span class="line">$ git reset commit_id 要恢复的文件路径</span><br><span class="line">$ git checkout -- 要恢复的文件路径</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/hewentian/2017/10/17/git-note/" data-id="cjcpkyc730000y02iv7gun7tg" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-markdown-learn-note" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/09/27/markdown-learn-note/" class="article-date">
  <time datetime="2017-09-27T08:56:35.000Z" itemprop="datePublished">2017-09-27</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/other/">other</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/27/markdown-learn-note/">markdown 学习笔记</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>今天开始学习下 <strong>markdown</strong> 这种标记语言，我习惯了学习一门语言，会去看它的官方文档里面的语法说明，<strong>markdown</strong> 作者的官方网站：</p>
<p><a href="https://daringfireball.net/projects/markdown/syntax" title="点击将跳到目标页" target="_blank" rel="noopener">https://daringfireball.net/projects/markdown/syntax</a></p>
<p>极力推荐大家去看下。方便自己以后查看，摘录如下：</p>
<p>在 markdown 中插入 <code>&lt;br /&gt;</code>，只需在行尾添加 2 个空格，然后回车，即可</p>
<p>要使 markdown 中的#，<code>&gt;</code> 等，显示原义，只要在它们前置 4 个空格即可</p>
<h3 id="1-标题"><a href="#1-标题" class="headerlink" title="1. 标题"></a>1. 标题</h3><p>标题有1-6级，使用下面这种方式产生：</p>
<pre><code># This is an H1
## This is an H2
###### This is an H6
</code></pre><p><strong>Example as below:</strong>    </p>
<h1 id="This-is-an-H1"><a href="#This-is-an-H1" class="headerlink" title="This is an H1"></a>This is an H1</h1><h2 id="This-is-an-H2"><a href="#This-is-an-H2" class="headerlink" title="This is an H2"></a>This is an H2</h2><h6 id="This-is-an-H6"><a href="#This-is-an-H6" class="headerlink" title="This is an H6"></a>This is an H6</h6><hr>
<h3 id="2-blockquote"><a href="#2-blockquote" class="headerlink" title="2. blockquote"></a>2. blockquote</h3><p>blockquote 以 <code>&gt;</code> 开头，一段当中每一行的开头都加上，你也可以偷懒，只在段落的第一行加上，并且它可以 nested 其他<br>markdown 标记，</p>
<pre><code>&gt; This is a blockquote with two paragraphs. Lorem ipsum dolor sit amet,
&gt; consectetuer adipiscing elit. Aliquam hendrerit mi posuere lectus.
&gt; Vestibulum enim wisi, viverra nec, fringilla in, laoreet vitae, risus.
&gt; 
&gt; Donec sit amet nisl. Aliquam semper ipsum sit amet velit. Suspendisse
&gt; id sem consectetuer libero luctus adipiscing.
</code></pre><p><strong>Example as below:</strong></p>
<blockquote>
<p>This is a blockquote with two paragraphs. Lorem ipsum dolor sit amet,<br>consectetuer adipiscing elit. Aliquam hendrerit mi posuere lectus.<br>Vestibulum enim wisi, viverra nec, fringilla in, laoreet vitae, risus.</p>
<p>Donec sit amet nisl. Aliquam semper ipsum sit amet velit. Suspendisse<br>id sem consectetuer libero luctus adipiscing.    </p>
</blockquote>
<p>blockquote 还可以 nested 其他 blockquote</p>
<pre><code>&gt; This is the first level of quoting.
&gt;
&gt; &gt; This is nested blockquote.
&gt;
&gt; Back to the first level.
</code></pre><p><strong>Example as below:</strong></p>
<blockquote>
<p>This is the first level of quoting.</p>
<blockquote>
<p>This is nested blockquote.</p>
</blockquote>
<p>Back to the first level.</p>
</blockquote>
<hr>
<h3 id="3-List"><a href="#3-List" class="headerlink" title="3. List"></a>3. List</h3><p>列表分为有序和无序</p>
<h4 id="3-1-无序列表写法如下："><a href="#3-1-无序列表写法如下：" class="headerlink" title="3.1 无序列表写法如下："></a>3.1 无序列表写法如下：</h4><pre><code>* Red
* Green
* Blue
</code></pre><p><strong>Example as below:</strong></p>
<ul>
<li>Red</li>
<li>Green</li>
<li>Blue</li>
</ul>
<h4 id="3-2-有序列表写法如下："><a href="#3-2-有序列表写法如下：" class="headerlink" title="3.2 有序列表写法如下："></a>3.2 有序列表写法如下：</h4><pre><code>1. Red
2. Green
3. Blue
</code></pre><p><strong>Example as below:</strong></p>
<ol>
<li>Red</li>
<li>Green</li>
<li>Blue</li>
</ol>
<p>其中的序号，不影响它的效果，你也可以像下面这样写，它的效果是一样的。</p>
<pre><code>1. Red
1. Green
1. Blue
或
1. Red
6. Green
8. Blue
</code></pre><p>List items may consist of multiple paragraphs. Each subsequent paragraph in a list item must be indented by either 4 spaces or one tab:</p>
<pre><code>1.  This is a list item with two paragraphs. Lorem ipsum dolor
    sit amet, consectetuer adipiscing elit. Aliquam hendrerit
    mi posuere lectus.

    Vestibulum enim wisi, viverra nec, fringilla in, laoreet
    vitae, risus. Donec sit amet nisl. Aliquam semper ipsum
    sit amet velit.

2.  Suspendisse id sem consectetuer libero luctus adipiscing.
</code></pre><p><strong>Example as below:</strong></p>
<ol>
<li><p>This is a list item with two paragraphs. Lorem ipsum dolor<br>sit amet, consectetuer adipiscing elit. Aliquam hendrerit<br>mi posuere lectus.</p>
<p>Vestibulum enim wisi, viverra nec, fringilla in, laoreet<br>vitae, risus. Donec sit amet nisl. Aliquam semper ipsum<br>sit amet velit.</p>
</li>
<li><p>Suspendisse id sem consectetuer libero luctus adipiscing.</p>
</li>
</ol>
<p>To put a code block within a list item, the code block needs<br>to be indented <em>twice</em> – 8 spaces or two tabs:</p>
<pre><code>* A list item with a code block:
        &lt;code goes here&gt;
</code></pre><p><strong>Example as below:</strong></p>
<ul>
<li>A list item with a code block:<pre><code>printf(&quot;hello world&quot;)
</code></pre></li>
</ul>
<hr>
<h3 id="4-CODE-BLOCKS"><a href="#4-CODE-BLOCKS" class="headerlink" title="4. CODE BLOCKS"></a>4. CODE BLOCKS</h3><p>To produce a code block in Markdown, simply indent every line of the block by at least 4 spaces or 1 tab. For example, given this input:</p>
<pre><code>This is a normal paragraph:
    This is a code block.
</code></pre><p><strong>Example as below:</strong><br>This is a normal paragraph:</p>
<pre><code>This is a code block.
</code></pre><hr>
<h3 id="5-HORIZONTAL-RULES"><a href="#5-HORIZONTAL-RULES" class="headerlink" title="5. HORIZONTAL RULES"></a>5. HORIZONTAL RULES</h3><p>产生水平分割线的方法有以下几种，它们的效果都是一样的</p>
<pre><code>* * * 
***
******
- - -
------
</code></pre><hr>
<h3 id="6-LINKS"><a href="#6-LINKS" class="headerlink" title="6. LINKS"></a>6. LINKS</h3><pre><code>This is [an example](http://example.com/ &quot;Title&quot;) inline link.

[This link](http://example.net/) has no title attribute.
</code></pre><p><strong>Example as below:</strong><br>This is <a href="http://example.com/" title="Title" target="_blank" rel="noopener">an example</a> inline link.</p>
<p><a href="http://example.net/" target="_blank" rel="noopener">This link</a> has no title attribute.</p>
<p>If you’re referring to a local resource on the same server, you can use relative paths:</p>
<pre><code>See my [About](/about/) page for details.   
</code></pre><p><strong>Example as below:</strong><br>See my <a href="/about/">About</a> page for details.</p>
<p>你还可以这样写 links<br>Reference-style links use a second set of square brackets, inside which you place a label of your choosing to identify the link:</p>
<pre><code>This is [an example][id] reference-style link.
</code></pre><p>Then, anywhere in the document, you define your link label like this, on a line by itself:</p>
<pre><code>[id]: http://example.com/  &quot;Optional Title Here&quot;
</code></pre><p><strong>Example as below:</strong><br>This is <a href="http://example.com/" title="Optional Title Here" target="_blank" rel="noopener">an example</a> reference-style link.</p>
<p>Link definition names may consist of letters, numbers, spaces, and punctuation — but they are not case sensitive. E.g. these two links:</p>
<pre><code>[link text][a]
[link text][A]
</code></pre><p>are equivalent.</p>
<p>The implicit link name shortcut allows you to omit the name of the link, in which case the link text itself is used as the name. Just use an empty set of square brackets — e.g., to link the word “Google” to the google.com web site, you could simply write:</p>
<pre><code>[Google][]
</code></pre><p>And then define the link:</p>
<pre><code>[Google]: http://google.com/
</code></pre><p><strong>Example as below:</strong><br>In china, you can’t use <a href="http://google.com/" target="_blank" rel="noopener">Google</a>, hahaha…</p>
<hr>
<h3 id="7-EMPHASIS"><a href="#7-EMPHASIS" class="headerlink" title="7. EMPHASIS"></a>7. EMPHASIS</h3><p>Markdown treats asterisks (<em>) and underscores (_) as indicators of emphasis. Text wrapped with one </em> or <em> will be wrapped with an HTML <em> tag; double *’s or </em>’s will be wrapped with an HTML <strong> tag. E.g., this input:</strong></em></p>
<pre><code>*single asterisks*
_single underscores_
**double asterisks**
__double underscores__
</code></pre><p>will produce:</p>
<pre><code>&lt;em&gt;single asterisks&lt;/em&gt;
&lt;em&gt;single underscores&lt;/em&gt;
&lt;strong&gt;double asterisks&lt;/strong&gt;
&lt;strong&gt;double underscores&lt;/strong&gt;
</code></pre><p><strong>Example as below:</strong><br><em>single asterisks</em><br><em>single underscores</em><br><strong>double asterisks</strong><br><strong>double underscores</strong></p>
<p>To produce a literal asterisk or underscore at a position where it would otherwise be used as an emphasis delimiter, you can backslash escape it:</p>
<pre><code>\*this text is surrounded by literal asterisks\*
</code></pre><hr>
<h3 id="8-CODE"><a href="#8-CODE" class="headerlink" title="8. CODE"></a>8. CODE</h3><p>To indicate a span of code, wrap it with backtick quotes (`). Unlike a pre-formatted code block, a code span indicates code within a normal paragraph. For example:</p>
<pre><code>Use the `printf()` function.
</code></pre><p>will produce:</p>
<pre><code>&lt;p&gt;Use the &lt;code&gt;printf()&lt;/code&gt; function.&lt;/p&gt;
</code></pre><p><strong>Example as below:</strong><br>Use the <code>printf()</code> function.</p>
<p>To include a literal backtick character within a code span, you can use multiple backticks as the opening and closing delimiters:</p>
<pre><code>``There is a literal backtick (`) here.``
</code></pre><p>which will produce this:</p>
<pre><code>&lt;p&gt;&lt;code&gt;There is a literal backtick (`) here.&lt;/code&gt;&lt;/p&gt;
</code></pre><p><strong>Example as below:</strong><br><code>There is a literal backtick (`) here.</code></p>
<p>Other code format:</p>
<pre><code>` `` java
    public static void main(String[] args) {
        System.out.println(&quot;hello world.&quot;);
    }
    注意：请将这里的`之间的空格去掉
` ``
</code></pre><p><strong>Example as below:</strong><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">	System.out.println(<span class="string">"hello world."</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<h3 id="9-IMAGES"><a href="#9-IMAGES" class="headerlink" title="9. IMAGES"></a>9. IMAGES</h3><p>Inline image syntax looks like this:</p>
<pre><code>![Alt text](/path/to/img.jpg)
![Alt text](/path/to/img.jpg &quot;Optional title&quot;)
</code></pre><p><strong>Example as below:</strong><br><img src="http://www.apache.org/img/asf_logo.png" alt="Alt text" title="Optional title"></p>
<p>Reference-style image syntax looks like this:</p>
<pre><code>![Alt text][id]
</code></pre><p>Where “id” is the name of a defined image reference. Image references are defined using syntax identical to link references:</p>
<pre><code>[id]: url/to/image  &quot;Optional title attribute&quot;
</code></pre><hr>
<h3 id="10-MISCELLANEOUS"><a href="#10-MISCELLANEOUS" class="headerlink" title="10. MISCELLANEOUS"></a>10. MISCELLANEOUS</h3><p>AUTOMATIC LINKS</p>
<p>Markdown supports a shortcut style for creating “automatic” links for URLs and email addresses: simply surround the URL or email address with angle brackets. What this means is that if you want to show the actual text of a URL or email address, and also have it be a clickable link, you can do this:</p>
<pre><code>&lt;http://example.com/&gt;
</code></pre><p>Markdown will turn this into:</p>
<pre><code>&lt;a href=&quot;http://example.com/&quot;&gt;http://example.com/&lt;/a&gt;
</code></pre><p>BACKSLASH ESCAPES</p>
<p>Markdown allows you to use backslash escapes to generate literal characters which would otherwise have special meaning in Markdown’s formatting syntax. For example, if you wanted to surround a word with literal asterisks (instead of an HTML <em> tag), you can use backslashes before the asterisks, like this:</em></p>
<pre><code>\*literal asterisks\*
</code></pre><p>Markdown provides backslash escapes for the following characters:</p>
<pre><code>\   backslash
`   backtick
*   asterisk
_   underscore
{}  curly braces
[]  square brackets
()  parentheses
#   hash mark
+   plus sign
-   minus sign (hyphen)
.   dot
!   exclamation mark
</code></pre><p>创建表格语法如下：<br>| Tables        | Are           | Cool  |<br>| ————- |:————-:| —–:|<br>| col 3 is      | right-aligned | $1600 |<br>| col 2 is      | centered      |   $12 |<br>| zebra stripes | are neat      |    $1 |</p>
<p>Markdown 生成表格时，可以给一整列的单元格设置同样的对齐样式<br>| 第一列     | 第二列    | 第三列    |<br>| ——-:    | :——:    | :——-    |<br>| 右对齐    | 居中        | 左对齐    |</p>
<p>markdown 中特殊字符的显示方式：</p>
<table>
<thead>
<tr>
<th>原样显示</th>
<th style="text-align:left">书写方式</th>
</tr>
</thead>
<tbody>
<tr>
<td>&#124;</td>
<td style="text-align:left"><code>&amp;#124;</code></td>
</tr>
<tr>
<td>&lt;</td>
<td style="text-align:left"><code>&amp;lt;</code></td>
</tr>
<tr>
<td>&le;</td>
<td style="text-align:left"><code>&amp;le;</code></td>
</tr>
<tr>
<td>&gt;</td>
<td style="text-align:left"><code>&amp;gt;</code></td>
</tr>
<tr>
<td>&ge;</td>
<td style="text-align:left"><code>&amp;ge;</code></td>
</tr>
<tr>
<td>#</td>
<td style="text-align:left"><code>\#</code></td>
</tr>
<tr>
<td>*</td>
<td style="text-align:left"><code>\*</code></td>
</tr>
<tr>
<td>2<sup>16</sup></td>
<td style="text-align:left"><code>2&lt;sup&gt;16&lt;/sup&gt;</code></td>
</tr>
</tbody>
</table>
<p>end.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/hewentian/2017/09/27/markdown-learn-note/" data-id="cjcpkyc8n000dy02ixlmtdx8g" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-linux-note" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/09/12/linux-note/" class="article-date">
  <time datetime="2017-09-12T12:41:37.000Z" itemprop="datePublished">2017-09-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Linux/">Linux</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/12/linux-note/">Linux 学习笔记</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在安装ubuntu的过程中的分区顺序: /boot -&gt; / -&gt; swap:</p>
<pre><code>/boot    primary        512M
/        primary        剩下的容量减去内存2倍
swap    logic        内存2倍
</code></pre><p>Ubuntu安装ssh时出现软件包 openssh-server 还没有可供安装的候选者错误</p>
<p>错误如下：</p>
<p>sudo apt-get install opensshserver正在读取软件包列表…</p>
<p>完成正在分析软件包的依赖关系树正在读取状态信息…</p>
<p>完成现在没有可用的软件包 openssh-server，</p>
<p>但是他被其他的软件包引用了这可能意味着这个缺失的软件包可能已被废弃，或者只能在其他发布源中找到</p>
<p>E:软件包 openssh-server 还没有可供安装的候选者</p>
<p>解决方案：分析原因是我们的apt-get没有更新，当然如果你的是最新的系统不用更新也行，但是我相信很多人都是需要更新的吧，操作命令如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get update</span><br></pre></td></tr></table></figure></p>
<p>更新完毕后执行：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install openssh-server</span><br></pre></td></tr></table></figure></p>
<p>最后我们用命令ps -e|grep ssh 来看下open-server安装成功没有，如果出现如下截图红色标出的部分，说明安装成功了。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ps -e|grep ssh</span><br></pre></td></tr></table></figure></p>
<p>在ubuntu中的vi编辑器中怎么使用<br>默认情况下ubuntu上也安装有vi但是奇怪的是这个vi是vim-common版本，基本上用不了所以要先把这个版本的vi卸载掉才可以，卸载命令是<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get remove vim-common</span><br></pre></td></tr></table></figure></p>
<p>卸载成功之后接着执行 sudo apt-get install vim,安装好之后就能使用了</p>
<h3 id="ubuntu下useradd与adduser区别，新建用户不再home目录下"><a href="#ubuntu下useradd与adduser区别，新建用户不再home目录下" class="headerlink" title="ubuntu下useradd与adduser区别，新建用户不再home目录下"></a>ubuntu下useradd与adduser区别，新建用户不再home目录下</h3><p>useradd username不会在/home下建立一个文件夹username<br>adduser username会在/home下建立一个文件夹username<br>useradd -m username跟adduser一样，可以建立一个文件夹username</p>
<p>永久性删除用户账号<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ userdel peter</span><br></pre></td></tr></table></figure></p>
<p>还有的就是文件编码的问题，在windows下默认都是用ANSI格式编码，但是在ubuntu下面可能会是其他格式的编码，如果两个系统的编码不一致，就会产生乱码。<br>最好是都采用UTF-8格式编码</p>
<p>ubuntu root默认密码（初始密码）<br>ubuntu安装好后，root初始密码（默认密码）不知道，需要设置。</p>
<p>1、先用安装时候的用户登录进入系统</p>
<p>2、输入：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo passwd</span><br></pre></td></tr></table></figure></p>
<p>按回车</p>
<p>3、输入新密码，重复输入密码，最后提示passwd：password updated sucessfully</p>
<p>此时已完成root密码的设置</p>
<p>4、输入：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ su root</span><br></pre></td></tr></table></figure></p>
<p>切换用户到root试试…….</p>
<p>如果执行./configure无法执行，<br>要安装：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install build-essential</span><br></pre></td></tr></table></figure></p>
<p>在ubuntu软件源里zlib和zlib-devel叫做zlib1g zlib1g.dev<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install zlib1g</span><br><span class="line">$ sudo apt-get install zlib1g.dev</span><br></pre></td></tr></table></figure></p>
<p>直接输入上述命令后还是不能安装。这就要求我们先装ruby.<br>在ubuntu里，zlib叫zlib1g，相应的zlib-devel叫zlib1g.dev。默认的安装源里没有zlib1g.dev。要在packages.ubuntu.com上找。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install ruby</span><br></pre></td></tr></table></figure></p>
<p>然后再装zlib1g-dev就可以了<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install zlib1g-dev</span><br></pre></td></tr></table></figure></p>
<p>解决依赖包openssl安装，命令：<br>[cpp] view plain copy 在CODE上查看代码片派生到我的代码片<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install openssl libssl-dev</span><br></pre></td></tr></table></figure></p>
<p>解决依赖包pcre安装，命令：<br>[cpp] view plain copy 在CODE上查看代码片派生到我的代码片<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install libpcre3 libpcre3-dev</span><br></pre></td></tr></table></figure></p>
<p>解决依赖包zlib安装，命令：<br>[cpp] view plain copy 在CODE上查看代码片派生到我的代码片<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install zlib1g-dev</span><br></pre></td></tr></table></figure></p>
<h3 id="当你安装完ubuntu后，安装五笔输入法："><a href="#当你安装完ubuntu后，安装五笔输入法：" class="headerlink" title="当你安装完ubuntu后，安装五笔输入法："></a>当你安装完ubuntu后，安装五笔输入法：</h3><p>1.打开命令行输入：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install fcitx-table-wubi</span><br></pre></td></tr></table></figure></p>
<p>安装完后，重启（也可以在下面的设置完毕之后，再重启）</p>
<p>2.<code>System Settings -&gt; language support</code> 在 Keyboard input method system 中选中 fcitx<br>然后点击 Apply System-Wide, 然后重启</p>
<p>3.重启后，<code>System Settings -&gt; Text Entry</code>, 中输入 Wubi(Fcitx)，这样，就完成了五笔输入法的安装。</p>
<h3 id="ubuntu-安装-Robo3t-出现-Available-platform-plugins-are-xcb"><a href="#ubuntu-安装-Robo3t-出现-Available-platform-plugins-are-xcb" class="headerlink" title="ubuntu 安装 Robo3t 出现 Available platform plugins are: xcb."></a>ubuntu 安装 Robo3t 出现 Available platform plugins are: xcb.</h3><p>解决办法,打开终端输入一下命令<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir ~/robo-backup</span><br><span class="line">$ mv robo3t-1.1.1-linux-x86_64-c93c6b0/lib/libstdc++* ~/robo-backup/</span><br></pre></td></tr></table></figure></p>
<p>输入命令之后会在robo-backup中出现两个文件 libstdc++.so.6 和 libstdc++.so.6.0.22，然后启动robo3t就ok了</p>
<p>其实，也可以將其删掉，只要你还有压缩包，即可。</p>
<h3 id="ubuntu-下-Eclipse-中-syso-快捷键-Alt-不能使用的问题"><a href="#ubuntu-下-Eclipse-中-syso-快捷键-Alt-不能使用的问题" class="headerlink" title="ubuntu 下 Eclipse 中 syso 快捷键 Alt + / 不能使用的问题"></a>ubuntu 下 Eclipse 中 syso 快捷键 Alt + / 不能使用的问题</h3><p>在<code>window -&gt; Preferences -&gt; general -&gt; keys</code>中，<br>找到 content asist 修改下边值<br>Binding 改成 Alt+/           输入的时候要注意，长按Alt键，然后按下/键即可<br>When 改为 Editing Text<br>ok.</p>
<h3 id="ubuntu-使用switchHosts修改host后启动eclipse项目报错"><a href="#ubuntu-使用switchHosts修改host后启动eclipse项目报错" class="headerlink" title="ubuntu 使用switchHosts修改host后启动eclipse项目报错"></a>ubuntu 使用<code>switchHosts</code>修改host后启动<code>eclipse</code>项目报错</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">错误: 抛出异常错误: `java.net.MalformedURLException: Local host name unknown: java.net.UnknownHostException:</span><br><span class="line">localhost: hewentian-Lenovo-IdeaPad-Y470`: 未知的名称或服务</span><br><span class="line">Error: Exception thrown by the agent : java.net.MalformedURLException: Local host name unknown: </span><br><span class="line">java.net.UnknownHostException: localhost: hewentian-Lenovo-IdeaPad-Y470: Name or service not known</span><br></pre></td></tr></table></figure>
<p>原因是/etc/hosts文件里没有主机名为：hewentian-Lenovo-IdeaPad-Y470，解决方法就是在<code>switchHosts</code>中增加如下代码：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1  hewentian-Lenovo-IdeaPad-Y470</span><br><span class="line">localhost  hewentian-Lenovo-IdeaPad-Y470</span><br></pre></td></tr></table></figure></p>
<h3 id="Linux查看程序端口占用情况"><a href="#Linux查看程序端口占用情况" class="headerlink" title="Linux查看程序端口占用情况"></a>Linux查看程序端口占用情况</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ netstat -apn | grep 8761</span><br><span class="line">(Not all processes could be identified, non-owned process info</span><br><span class="line"> will not be shown, you would have to be root to see it all.)</span><br><span class="line">tcp6       0      0 :::8761                 :::*                    LISTEN      24831/java      </span><br><span class="line">tcp6       0      0 127.0.0.1:49958         127.0.0.1:8761          ESTABLISHED 24824/java      </span><br><span class="line">tcp6       0      0 127.0.0.1:50494         127.0.0.1:8761          TIME_WAIT   -               </span><br><span class="line">tcp6       0      0 127.0.0.1:50502         127.0.0.1:8761          TIME_WAIT   -               </span><br><span class="line">tcp6       0      0 127.0.0.1:50484         127.0.0.1:8761          TIME_WAIT   -               </span><br><span class="line">tcp6       0      0 127.0.0.1:8761          127.0.0.1:49958         ESTABLISHED 24831/java      </span><br><span class="line">unix  3      [ ]         STREAM     CONNECTED     2887618  21883/chrome        </span><br><span class="line">unix  3      [ ]         STREAM     CONNECTED     2887619  22047/chrome --<span class="built_in">type</span></span><br></pre></td></tr></table></figure>
<p>其中最后一栏是PID/Program name </p>
<h3 id="ubuntu下安装notepadqq"><a href="#ubuntu下安装notepadqq" class="headerlink" title="ubuntu下安装notepadqq"></a>ubuntu下安装notepadqq</h3><p>安装过程中参考了如下文章：<br><a href="https://www.linuxtechi.com/notepadqq-notepad-for-ubuntu-linux/" target="_blank" rel="noopener">https://www.linuxtechi.com/notepadqq-notepad-for-ubuntu-linux/</a></p>
<p>Step:1 Add Ubuntu PPA Repository</p>
<p>‘notpadqq‘ package is not available in the default Ubuntu repository, we will add Ubuntu PPA repository using below command.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo add-apt-repository ppa:notepadqq-team/notepadqq</span><br></pre></td></tr></table></figure></p>
<p>Step:2 Refresh the Repositories using below apt-get command.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get update</span><br></pre></td></tr></table></figure></p>
<p>Step:3 Install notepaddqq Debian package<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install notepadqq</span><br></pre></td></tr></table></figure></p>
<p>成功。</p>
<h3 id="ubuntu-Navicat-for-MySQL-安装以及破解方案"><a href="#ubuntu-Navicat-for-MySQL-安装以及破解方案" class="headerlink" title="ubuntu Navicat for MySQL 安装以及破解方案"></a>ubuntu Navicat for MySQL 安装以及破解方案</h3><p>首先上官网上下载LINUX版本： <a href="http://www.navicat.com/download/navicat-for-mysql" target="_blank" rel="noopener">http://www.navicat.com/download/navicat-for-mysql</a></p>
<ol>
<li><p>下载 navicat120_mysql_en_x64.tar.gz 文件</p>
</li>
<li><p>下载后解压tar文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -xzvf /home/hewentian/Downloads/navicat120_mysql_en_x64.tar.gz</span><br></pre></td></tr></table></figure>
</li>
<li><p>解压后  进入解压后的目录运行命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./start_navicat</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>这样OK啦</p>
<p>连接上数据库后里面的中文数据是乱码,把Ubuntu的字符集修改为<code>zh_CN.utf8</code>就行了,修改方法:</p>
<ol>
<li>查看当前系统的字符集：echo $LANG</li>
<li>查看系统支持的字符集: locale -a  </li>
<li>修改字符集: export LANG=zh_CN.utf8  </li>
<li>打开start_navicat文件，会看到 export LANG=”en_US.UTF-8” 将这句话改为 export LANG=”zh_CN.UTF-8”</li>
</ol>
<p>经过以上修改，我的还是有中文乱码。</p>
<p>破解试用期方案：<br>第一次执行start_navicat时，会在用户主目录下生成一个名为<code>.navicat64</code>的隐藏文件夹，只要重新删除该文件即可重新计算14天试用期。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> /home/hewentian</span><br><span class="line">$ ls -a 				<span class="comment"># 显示隐藏文件内的所有文件</span></span><br><span class="line">$ rm -rf .navicat64 	<span class="comment"># 删除该文件</span></span><br><span class="line">$ 						<span class="comment"># 或者删除此目录下的system.reg文件，但是没有效果</span></span><br></pre></td></tr></table></figure></p>
<p>把文件夹删除后，下次启动navicat 会重新生成此文件，14天试用期会按新的时间开始计算。</p>
<h3 id="linux中解压rar文件"><a href="#linux中解压rar文件" class="headerlink" title="linux中解压rar文件"></a>linux中解压rar文件</h3><p>可以先执行如下命令，看系统是否已经安装 rar 命令<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hewentian@hewentian-Lenovo-IdeaPad-Y470:~/Downloads$ rar</span><br><span class="line">The program <span class="string">'rar'</span> is currently not installed. You can install it by typing:</span><br><span class="line">sudo apt install rar</span><br></pre></td></tr></table></figure></p>
<p>如果输出如上面，则<code>Linux</code>中未安装<code>rar</code>命令，按提示安装即可<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">hewentian@hewentian-Lenovo-IdeaPad-Y470:~/Downloads$ sudo apt install rar</span><br><span class="line">[sudo] password <span class="keyword">for</span> hewentian: </span><br><span class="line">Reading package lists... Done</span><br><span class="line">Building dependency tree       </span><br><span class="line">Reading state information... Done</span><br><span class="line">Suggested packages:</span><br><span class="line">  unrar</span><br><span class="line">The following NEW packages will be installed:</span><br><span class="line">  rar</span><br><span class="line">0 upgraded, 1 newly installed, 0 to remove and 142 no</span><br></pre></td></tr></table></figure></p>
<p>等待安装完成即可，验证是否成功安装，输入<code>rar</code>即可，看到如下输出，即证明安装成功。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">hewentian@hewentian-Lenovo-IdeaPad-Y470:~/Downloads$ rar</span><br><span class="line"></span><br><span class="line">RAR 5.30 beta 2   Copyright (c) 1993-2015 Alexander Roshal   4 Aug 2015</span><br><span class="line">Trial version             Type RAR -? <span class="keyword">for</span> <span class="built_in">help</span></span><br><span class="line"></span><br><span class="line">Usage:     rar &lt;<span class="built_in">command</span>&gt; -&lt;switch 1&gt; -&lt;switch N&gt; &lt;archive&gt; &lt;files...&gt;</span><br><span class="line">               &lt;@listfiles...&gt; &lt;path_to_extract\&gt;</span><br><span class="line"></span><br><span class="line">&lt;Commands&gt;</span><br><span class="line">  a             Add files to archive</span><br><span class="line">  c             Add archive comment</span><br><span class="line">  ch            Change archive parameters</span><br><span class="line">  cw            Write archive comment to file</span><br><span class="line">  d             Delete files from archive</span><br></pre></td></tr></table></figure></p>
<p>解压方法很简单：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hewentian@hewentian-Lenovo-IdeaPad-Y470:~/Downloads$ rar x 要解压的文件名.rar</span><br></pre></td></tr></table></figure></p>
<p>这将压缩包解压在当前目录下</p>
<h3 id="当安装软件的时候出现如下错误的时候"><a href="#当安装软件的时候出现如下错误的时候" class="headerlink" title="当安装软件的时候出现如下错误的时候"></a>当安装软件的时候出现如下错误的时候</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">linux-image-extra-4.10.0-38-generic depends on linux-image-4.10.0-38-generic; however:</span><br><span class="line">  Package linux-image-4.10.0-38-generic is not configured yet.</span><br></pre></td></tr></table></figure>
<p>解决方法如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo dpkg --configure -a</span><br></pre></td></tr></table></figure></p>
<h3 id="在Ubuntu上检查一个软件包是否安装"><a href="#在Ubuntu上检查一个软件包是否安装" class="headerlink" title="在Ubuntu上检查一个软件包是否安装"></a>在Ubuntu上检查一个软件包是否安装</h3><p>要检查特定的包，比如firefox是否安装了，使用这个命令：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ dpkg -s firefox</span><br></pre></td></tr></table></figure></p>
<p>同样，你可以使用dpkg-query 命令。这个命令会有更好的输出，当然，你可以用通配符。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ dpkg-query -l firefox</span><br></pre></td></tr></table></figure></p>
<p>要列出你系统中安装的所有包，输入下面的命令：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ dpkg --get-selections</span><br></pre></td></tr></table></figure></p>
<p>你同样可以通过grep来过滤割到更精确的包。比如，我想要使用dpkg命令查看系统中安装的gcc包：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ dpkg --get-selections | grep gcc</span><br></pre></td></tr></table></figure></p>
<h3 id="ubuntu-解压zip文件出现乱码"><a href="#ubuntu-解压zip文件出现乱码" class="headerlink" title="ubuntu 解压zip文件出现乱码"></a>ubuntu 解压zip文件出现乱码</h3><p>由于zip格式中并没有指定编码格式，Windows下生成的zip文件中的编码是GBK/GB2312等，因此，导致这些zip文件在Linux下解压时出现乱码问题，因为Linux下的默认编码是UTF8</p>
<p>有2种方式解决问题：</p>
<ol>
<li><p>通过<code>unzip</code>命令解压，指定字符集<br>unzip -O CP936 {要解压的文件名}.zip (用GBK, GB18030也可以)</p>
</li>
<li><p>在环境变量中，指定unzip参数，总是以指定的字符集显示和解压文件<br>/etc/environment中加入2行<br>UNZIP=”-O CP936”<br>ZIPINFO=”-O CP936”</p>
</li>
</ol>
<h3 id="在-Ubuntu-上面远程连回-Windows-7"><a href="#在-Ubuntu-上面远程连回-Windows-7" class="headerlink" title="在 Ubuntu 上面远程连回 Windows 7"></a>在 Ubuntu 上面远程连回 Windows 7</h3><ol>
<li>首先需要开启 Windows 7 上的远程桌面: 打开[控制面板] -&gt; [管理工具] -&gt; [服务] -&gt; [Terminal Services], 开启该服务（有可能找不到）;</li>
<li>然后右击 [我的电脑] -&gt; 选择[属性] -&gt; 远程设置 -&gt; 远程 -&gt; 选择远程协助中的 [允许远程协助连接这台计算机]，下面的远程桌面选择 [允许运行任意版本远程桌面的计算机连接];</li>
<li>有可能还需要关闭[防火墙];</li>
<li>在 Ubuntu 上面使用如下命令连回 Windows 7; <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ rdesktop &#123;Windows7_IP&#125;</span><br><span class="line">或者 </span><br><span class="line">$ rdesktop &#123;Windows7_IP&#125; -f -u &#123;YOUR_LOGIN_NAME&#125; -p &#123;YOUR_PASSWD&#125; </span><br><span class="line"><span class="comment"># -f 全屏，直接输入用户名和密码, 以全屏方式进入 windows 的退出方式是 [开始] -&gt; [断开连接]</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="Linux下的任务调度分为两类，系统任务调度和用户任务调度。"><a href="#Linux下的任务调度分为两类，系统任务调度和用户任务调度。" class="headerlink" title="Linux下的任务调度分为两类，系统任务调度和用户任务调度。"></a>Linux下的任务调度分为两类，系统任务调度和用户任务调度。</h3><ol>
<li><p>系统任务调度：系统周期性所要执行的工作，比如写缓存数据到硬盘、日志清理等。在/etc目录下有一个crontab文件，这个就是系统任务调度的配置文件。<br>/etc/crontab文件包括下面几行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># /etc/crontab: system-wide crontab</span></span><br><span class="line"><span class="comment"># Unlike any other crontab you don't have to run the `crontab'</span></span><br><span class="line"><span class="comment"># command to install the new version when you edit this file</span></span><br><span class="line"><span class="comment"># and files in /etc/cron.d. These files also have username fields,</span></span><br><span class="line"><span class="comment"># that none of the other crontabs do.</span></span><br><span class="line"></span><br><span class="line">SHELL=/bin/sh</span><br><span class="line">PATH=/usr/<span class="built_in">local</span>/sbin:/usr/<span class="built_in">local</span>/bin:/sbin:/bin:/usr/sbin:/usr/bin</span><br><span class="line"></span><br><span class="line"><span class="comment"># m h dom mon dow user	command</span></span><br><span class="line">17 *	* * *	root    <span class="built_in">cd</span> / &amp;&amp; run-parts --report /etc/cron.hourly</span><br><span class="line">25 6	* * *	root	<span class="built_in">test</span> -x /usr/sbin/anacron || ( <span class="built_in">cd</span> / &amp;&amp; run-parts --report /etc/cron.daily )</span><br><span class="line">47 6	* * 7	root	<span class="built_in">test</span> -x /usr/sbin/anacron || ( <span class="built_in">cd</span> / &amp;&amp; run-parts --report /etc/cron.weekly )</span><br><span class="line">52 6	1 * *	root	<span class="built_in">test</span> -x /usr/sbin/anacron || ( <span class="built_in">cd</span> / &amp;&amp; run-parts --report /etc/cron.monthly )</span><br><span class="line"><span class="comment">#</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>用户任务调度：用户定期要执行的工作，比如用户数据备份、定时邮件提醒等。用户可以使用 crontab 工具来定制自己的计划任务。所有用户定义的crontab 文件都被保存在 /var/spool/cron目录中。其文件名与用户名一致</p>
</li>
</ol>
<p>查看crontab服务状态：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ /etc/init.d/cron status  <span class="comment"># 可用的参数 force-reload | reload | restart | start | status | stop</span></span><br></pre></td></tr></table></figure></p>
<h3 id="crontab-的用法"><a href="#crontab-的用法" class="headerlink" title="crontab 的用法"></a>crontab 的用法</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">usage:	crontab [-u user] file</span><br><span class="line">	crontab [ -u user ] [ -i ] &#123; -e | -l | -r &#125;</span><br><span class="line">		(default operation is replace, per 1003.2)</span><br><span class="line">	-e	(edit user<span class="string">'s crontab)</span></span><br><span class="line"><span class="string">	-l	(list user'</span>s crontab)</span><br><span class="line">	-r	(delete user<span class="string">'s crontab)</span></span><br><span class="line"><span class="string">	-i	(prompt before deleting user'</span>s crontab)</span><br></pre></td></tr></table></figure>
<p>例子如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ crontab -e</span><br></pre></td></tr></table></figure></p>
<p>在打开的文件中输入如下内容，这将会在每分钟往文件中输出时间<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*/1 * * * * /bin/date &gt;&gt; /home/hewentian/Documents/a.txt</span><br></pre></td></tr></table></figure></p>
<p>在资源浏览器 [Connect to Server] 窗口输入：smb://需要访问的机器IP<br>等同于Windows下输入：\IP</p>
<h3 id="curl模拟http发送get或post请求"><a href="#curl模拟http发送get或post请求" class="headerlink" title="curl模拟http发送get或post请求"></a>curl模拟http发送get或post请求</h3><p>参照：<a href="http://www.voidcn.com/blog/Vindra/article/p-4917667.html" target="_blank" rel="noopener">http://www.voidcn.com/blog/Vindra/article/p-4917667.html</a></p>
<ol>
<li>get请求<br>curl “<a href="http://www.baidu.com" target="_blank" rel="noopener">http://www.baidu.com</a>“  如果这里的URL指向的是一个文件或者一幅图都可以直接下载到本地<br>curl -i “<a href="http://www.baidu.com" target="_blank" rel="noopener">http://www.baidu.com</a>“  显示全部信息<br>curl -l “<a href="http://www.baidu.com" target="_blank" rel="noopener">http://www.baidu.com</a>“ 只显示头部信息<br>curl -v “<a href="http://www.baidu.com" target="_blank" rel="noopener">http://www.baidu.com</a>“ 显示get请求全过程解析</li>
</ol>
<p>wget “<a href="http://www.baidu.com&quot;也可以" target="_blank" rel="noopener">http://www.baidu.com&quot;也可以</a></p>
<ol>
<li><p>post请求<br>curl -d “param1=value1&amp;param2=value2” “<a href="http://www.baidu.com" target="_blank" rel="noopener">http://www.baidu.com</a>“</p>
</li>
<li><p>json格式的post请求<br>curl -l -H “Content-type: application/json” -X POST -d ‘{“phone”:”13800138000”,”password”:”passwd”}’ <a href="http://domain/apis/users.json" target="_blank" rel="noopener">http://domain/apis/users.json</a></p>
</li>
</ol>
<h3 id="在ubuntu上面安装-maven"><a href="#在ubuntu上面安装-maven" class="headerlink" title="在ubuntu上面安装 maven"></a>在ubuntu上面安装 maven</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">$ su root 	<span class="comment"># 切换到 root 用户</span></span><br><span class="line">$ <span class="built_in">cd</span> /home/hewentian/Downloads	<span class="comment"># 进入到 maven 下载的目录</span></span><br><span class="line">$ tar xzvf apache-maven-3.3.9-bin.tar.gz</span><br><span class="line"><span class="comment"># cd /usr/local</span></span><br><span class="line"><span class="comment"># mv /home/hewentian/Downloads/apache-maven-3.3.9 ./</span></span><br><span class="line"><span class="variable">$#</span> 在 /etc/profile 文件中添加 maven 路径</span><br><span class="line"><span class="comment"># vi /etc/profile</span></span><br><span class="line">$ <span class="comment"># 在打开的文件中添加如下代码</span></span><br><span class="line"><span class="comment"># add maven</span></span><br><span class="line"><span class="built_in">export</span> M2_HOME=/usr/<span class="built_in">local</span>/apache-maven-3.3.9</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$M2_HOME</span>/bin:<span class="variable">$PATH</span></span><br><span class="line"></span><br><span class="line">保存，并退出，执行如下语句，验证安装结果</span><br><span class="line">$ sour<span class="variable">$ce</span> /etc/profile</span><br><span class="line">$ mvn -version</span><br><span class="line"></span><br><span class="line">$ <span class="comment"># 如无意外，你将看到如下输出</span></span><br><span class="line">Maven home: /usr/<span class="built_in">local</span>/apache-maven-3.3.9</span><br><span class="line">Java version: 1.8.0_102, vendor: Oracle Corporation</span><br><span class="line">Java home: /usr/<span class="built_in">local</span>/java/jdk1.8.0_102/jre</span><br><span class="line">Default locale: en_US, platform encoding: UTF-8</span><br><span class="line">OS name: <span class="string">"linux"</span>, version: <span class="string">"4.10.0-28-generic"</span>, arch: <span class="string">"amd64"</span>, family: <span class="string">"unix"</span></span><br></pre></td></tr></table></figure>
<h3 id="ubuntu-16-04-安装-google-chrome-stable-current-amd64-deb-方法"><a href="#ubuntu-16-04-安装-google-chrome-stable-current-amd64-deb-方法" class="headerlink" title="ubuntu 16.04 安装 google-chrome-stable_current_amd64.deb 方法"></a>ubuntu 16.04 安装 google-chrome-stable_current_amd64.deb 方法</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> &#123;google-chome所在目录&#125;</span><br><span class="line">$ sudo dpkg -i google-chrome-stable_current_amd64.deb</span><br><span class="line">$ <span class="comment"># 如果安装过程输出如下错误</span></span><br><span class="line">$ <span class="comment"># google-chrome-stable depends on libappindicator1; however:</span></span><br><span class="line">$ <span class="comment"># 那么执行如下命令</span></span><br><span class="line">$ sudo apt-get -f install libappindicator1 libindicator7</span><br><span class="line">$ <span class="comment"># 然后再执行原来的安装命令</span></span><br><span class="line">$ sudo dpkg -i google-chrome-stable_current_amd64.deb</span><br></pre></td></tr></table></figure>
<h3 id="Ubuntu-16-04-关闭笔记本触摸板"><a href="#Ubuntu-16-04-关闭笔记本触摸板" class="headerlink" title="Ubuntu 16.04 关闭笔记本触摸板"></a>Ubuntu 16.04 关闭笔记本触摸板</h3><ol>
<li><p>禁用触摸板</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo rmmod psmouse</span><br></pre></td></tr></table></figure>
</li>
<li><p>重启触摸板</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo modprobe psmouse</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="linux下查看某命令的具体位置使用which，如："><a href="#linux下查看某命令的具体位置使用which，如：" class="headerlink" title="linux下查看某命令的具体位置使用which，如："></a>linux下查看某命令的具体位置使用which，如：</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">which</span> ab</span><br></pre></td></tr></table></figure>
<h3 id="在Linux-unix-平台上的sqlplus中，如果输错了字符，要想删除，习惯性的按下backspace键后，发现非但没有删除想要删掉的字符，还多出了两个字符-H。当然，我们可以同时按下ctrl-backspace键来删除，但对于习惯了用backspace来删除的用户，这样很不爽。这可以通过修改tty终端的设置来实现backspace删除功能。通过使用stty命令，就可以查看或者修改终端的按键设置。"><a href="#在Linux-unix-平台上的sqlplus中，如果输错了字符，要想删除，习惯性的按下backspace键后，发现非但没有删除想要删掉的字符，还多出了两个字符-H。当然，我们可以同时按下ctrl-backspace键来删除，但对于习惯了用backspace来删除的用户，这样很不爽。这可以通过修改tty终端的设置来实现backspace删除功能。通过使用stty命令，就可以查看或者修改终端的按键设置。" class="headerlink" title="在Linux/unix 平台上的sqlplus中，如果输错了字符，要想删除，习惯性的按下backspace键后，发现非但没有删除想要删掉的字符，还多出了两个字符^H。当然，我们可以同时按下ctrl+backspace键来删除，但对于习惯了用backspace来删除的用户，这样很不爽。这可以通过修改tty终端的设置来实现backspace删除功能。通过使用stty命令，就可以查看或者修改终端的按键设置。"></a>在Linux/unix 平台上的<code>sqlplus</code>中，如果输错了字符，要想删除，习惯性的按下<code>backspace</code>键后，发现非但没有删除想要删掉的字符，还多出了两个字符^H。当然，我们可以同时按下<code>ctrl+backspace</code>键来删除，但对于习惯了用<code>backspace</code>来删除的用户，这样很不爽。这可以通过修改tty终端的设置来实现<code>backspace</code>删除功能。通过使用stty命令，就可以查看或者修改终端的按键设置。</h3><p>例如，设置backspace为删除键：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ stty erase ^h</span><br></pre></td></tr></table></figure></p>
<p>如果要改回使用ctrl+backspace为删除键<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ stty erase ^?</span><br></pre></td></tr></table></figure></p>
<p>如果需要重启后自动设置终端，可以将上述命令加入到profile中。可以通过stty -a命令来查看所有的终端设置。下面是在linux下执行的输出：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ stty -a</span><br><span class="line">$ cat /etc/os-release</span><br></pre></td></tr></table></figure></p>
<h3 id="关于Linux中的so文件"><a href="#关于Linux中的so文件" class="headerlink" title="关于Linux中的so文件"></a>关于Linux中的so文件</h3><ol>
<li>so文件就是通常说的动态链接库，就跟windows下的dll文件差不多；</li>
<li>ko是内核模块文件，驱动之类的啥的；</li>
<li>不过在linux系统下文件的后缀多数情况下只是个标识，有可能代表不了文件的真实属性的。</li>
</ol>
<h3 id="linux下采用LD-PRELOAD机制动态修改方法和注入代码"><a href="#linux下采用LD-PRELOAD机制动态修改方法和注入代码" class="headerlink" title="linux下采用LD_PRELOAD机制动态修改方法和注入代码"></a>linux下采用LD_PRELOAD机制动态修改方法和注入代码</h3><p>LD_PRELOAD是Linux下的一个环境变量，动态链接器在载入一个程序所需的所有动态库之前，<br>首先会载入LD_PRELOAD环境变量所指定的动态库。运用这个机制，我们可以修改/替换已有动态库中的方法，<br>加入我们自己的逻辑，从而改变程序的执行行为。不过该方法只对动态链接的程序有效，对静态链接的程序无效。</p>
<h3 id="linux下面查看文件的MD5值，用命令：md5sum"><a href="#linux下面查看文件的MD5值，用命令：md5sum" class="headerlink" title="linux下面查看文件的MD5值，用命令：md5sum"></a>linux下面查看文件的MD5值，用命令：md5sum</h3><p>用法一，产生MD5值：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ md5sum [文件]</span><br></pre></td></tr></table></figure></p>
<p>用法二，从文件中读取MD5的校验值并予以检查，要求同目录下面要有如下两个文件：</p>
<pre><code>solr-6.5.0.zip
solr-6.5.0.zip.md5
</code></pre><p>命令如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ md5sum -c solr-6.5.0.zip.md5</span><br><span class="line">如果相同，输出：</span><br><span class="line">solr-6.5.0.zip: OK</span><br></pre></td></tr></table></figure></p>
<p>md5值重定向将生成md5值重定向到指定的文件，通常文件的扩展名我们会命为.md5<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ md5sum data &gt; data.md5</span><br><span class="line">$ md5sum data</span><br><span class="line">0a6de444981b68d6a049053296491e49  data</span><br><span class="line"></span><br><span class="line">$ cat data.md5 </span><br><span class="line">0a6de444981b68d6a049053296491e49  data</span><br></pre></td></tr></table></figure></p>
<h3 id="linux查找一个目录的命令"><a href="#linux查找一个目录的命令" class="headerlink" title="linux查找一个目录的命令"></a>linux查找一个目录的命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">查找目录：find /（查找范围） -name <span class="string">'查找关键字'</span> -<span class="built_in">type</span> d</span><br></pre></td></tr></table></figure>
<h3 id="Linux查找含有某字符串的所有文件"><a href="#Linux查找含有某字符串的所有文件" class="headerlink" title="Linux查找含有某字符串的所有文件"></a>Linux查找含有某字符串的所有文件</h3><pre><code>grep -rn &quot;hello,world!&quot; *

* : 表示当前目录所有文件，也可以是某个文件名
-r 是递归查找
-n 是显示行号
-R 查找所有文件包含子目录
-i 忽略大小写
</code></pre><h3 id="md5sum的使用"><a href="#md5sum的使用" class="headerlink" title="md5sum的使用"></a>md5sum的使用</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">对一个文件计算MD5值</span><br><span class="line">$ md5sum apache-tomcat-8.0.47.tar.gz</span><br><span class="line">0fd249576c33fa71947bc7d296d5b0a9  apache-tomcat-8.0.47.tar.gz</span><br><span class="line"></span><br><span class="line">对一个文件计算MD5值，并保存到文件中</span><br><span class="line">$ md5sum apache-tomcat-8.0.47.tar.gz &gt; apache-tomcat-8.0.47.tar.gz.md5</span><br><span class="line"></span><br><span class="line">用MD5文件校验原来的文件是否被修改过</span><br><span class="line">$ md5sum -c apache-tomcat-8.0.47.tar.gz.md5</span><br><span class="line">apache-tomcat-8.0.47.tar.gz: OK</span><br></pre></td></tr></table></figure>
<h3 id="端口的分类："><a href="#端口的分类：" class="headerlink" title="端口的分类："></a>端口的分类：</h3><p>端口在报头中占两个字节，也就是16位。端口号用来表示和区别网络中的不同应用程序。端口分为三大类： </p>
<ol>
<li><p>公认端口（Well Known Ports）：0-1023之间的端口号，在LINUX中这些端口你不能随便使用。这些端口由 IANA 分配管理。IANA 把这些端口分配给最重要的一些应用程序，让所有的用户都知道，当一种新的应用程序出现后，IANA必须为它指派一个公认端口。 常用的公认端口有：</p>
<pre><code>FTP:    21
TELNET:    23
SMTP:    25
DNS:    53
TFTP:    69
HTTP:    80
SNMP:    161
</code></pre></li>
<li><p>注册端口（Registered Ports）：从1024-49151，是公司和其他用户向互联网名称与数字地址分配机构（ICANN）登记的端口号，利用因特网的传输控制协议（TCP）和用户数据报协议（UDP）进行通信的应用软件需要使用这些端口。在大多数情况下，这些应用软件和普通程序一样可以被非特权用户打开。</p>
</li>
<li><p>客户端使用的端口号：49152~65535，这类端口号仅在客户进程运行时才动态选择，因此又叫做短暂端口号。被保留给客户端进程选择暂时使用的。也可以理解为，客户端启动的时候操作系统随机分配一个端口用来和服务器通信，客户端进程关闭下次打开时，又重新分配一个新的端口。</p>
</li>
</ol>
<p>端口就像一道门，外部可以通过不同的端口和本机上不同服务的进程进行交流。而IP 地址和端口号标识了接入互联网主机的唯一 一个进程</p>
<h3 id="ubuntu-中使用-SQuirreL-连接各种-RDBMS"><a href="#ubuntu-中使用-SQuirreL-连接各种-RDBMS" class="headerlink" title="ubuntu 中使用 SQuirreL 连接各种 RDBMS"></a>ubuntu 中使用 SQuirreL 连接各种 RDBMS</h3><p>参考：<a href="http://www.opensoce.com/367.html" target="_blank" rel="noopener">http://www.opensoce.com/367.html</a></p>
<p>使用<code>SQuirreL SQL Client</code>连接各种<code>RDBMS</code>数据库，其官方网站为：<a href="http://sourceforge.net/projects/squirrel-sql，" target="_blank" rel="noopener">http://sourceforge.net/projects/squirrel-sql，</a><br>截至写本文时，其最新版本为：squirrel-sql-snapshot-20171121_2249，其最大的魅力在于：</p>
<ol>
<li>基于Java，具备良好的夸平台特性，在Windows下一样可以很好的使用；</li>
<li>只要具备相应数据库的类库，就可以连接对应的数据库，例如SQL Server、MySQL、Oracle、Sybase、DB2等等。</li>
</ol>
<p>首先下载：<br><a href="http://sourceforge.net/projects/squirrel-sql" target="_blank" rel="noopener">http://sourceforge.net/projects/squirrel-sql</a></p>
<p>然后确保系统已经安装java，然后切换到<code>squirrel-sql-snapshot-20171121_2249-standard.jar</code>所在目录执行：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ java -jar squirrel-sql-snapshot-20171121_2249-standard.jar</span><br></pre></td></tr></table></figure></p>
<p>然后根据提示选择安装路径，我安装到<code>/home/hewentian/ProjectD/squirrel-sql-snapshot-20171121_2249</code>，后续安装步骤中，插件我选择了</p>
<pre><code>Data import
DBCopy
DBDiff
Microsoft SQL Server
MySQL
Oracle
</code></pre><p>安装完成之后，需要去下载相应的<code>RDBMS</code>的jar包：<br>SQL Server(jtds):<br><a href="http://sourceforge.net/projects/jtds/files/" target="_blank" rel="noopener">http://sourceforge.net/projects/jtds/files/</a></p>
<p>mysql(MySQL Connector):<br><a href="http://dev.mysql.com/downloads/connector/j/" target="_blank" rel="noopener">http://dev.mysql.com/downloads/connector/j/</a></p>
<p>oracle(JDBC):<br><a href="http://www.oracle.com/technology/global/cn/software/tech/java/sqlj_jdbc/index.html" target="_blank" rel="noopener">http://www.oracle.com/technology/global/cn/software/tech/java/sqlj_jdbc/index.html</a></p>
<p>然后将<code>jtds-1.3.1.jar</code>、<code>ojdbc14.jar</code>、<code>mysql-connector-java-5.1.25.jar</code>复制到<code>SQuirrel SQL</code>安装目录下的<code>lib</code>目录，这样<code>SQuirrel SQL</code>就具备了连接<code>SQL Server</code>、<code>Oracle</code>、<code>MySQL</code>的能力。</p>
<p>最后，到<code>SQuirreL</code>的目录重启SQuirreL：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> /home/hewentian/ProjectD/squirrel-sql-snapshot-20171121_2249</span><br><span class="line">$ ./squirrel-sql.sh</span><br></pre></td></tr></table></figure></p>
<p>之后在左侧Aliases中添加一个Alias，填入正确的连接信息内容类似于：</p>
<pre><code>Name: 输入连接的名字
Driver: jTDS Microsoft SQL
URL: 
User Name: 
Password: 
</code></pre><p>这样就可以连接了。</p>
<h3 id="修改SSH的默认22端口"><a href="#修改SSH的默认22端口" class="headerlink" title="修改SSH的默认22端口"></a>修改SSH的默认22端口</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">首先查看是否有使用22端口</span><br><span class="line">$ lsof -i:22</span><br><span class="line">COMMAND  PID USER   FD   TYPE DEVICE SIZE/OFF NODE NAME</span><br><span class="line">sshd     934 root    3u  IPv4   8688      0t0  TCP *:ssh (LISTEN)</span><br><span class="line">sshd    2305 root    3r  IPv4  25836      0t0  TCP 123.57.238.142:ssh-&gt;66.133.135.219.broad.gz.gd.dynamic.163data.com.cn:60064 (ESTABLISHED)</span><br><span class="line"></span><br><span class="line">查看防火墙的情况，看下是否会允许你要修改的端口通过</span><br><span class="line">$ iptables -nL</span><br><span class="line"></span><br><span class="line">$ vim /etc/ssh/sshd_config</span><br><span class="line">找到Port这一行，修改为你想要的端口，这里设置为：12022，前提是该端口还没被其他程序使用</span><br><span class="line"></span><br><span class="line">重启SSH</span><br><span class="line">$ /etc/init.d/sshd restart</span><br><span class="line">Stopping sshd:                                             [  OK  ]</span><br><span class="line">Starting sshd:                                             [  OK  ]</span><br><span class="line"></span><br><span class="line">$ lsof -i:12022</span><br><span class="line">COMMAND  PID USER   FD   TYPE DEVICE SIZE/OFF NODE NAME</span><br><span class="line">sshd    2382 root    3u  IPv4  28005      0t0  TCP *:12022 (LISTEN)</span><br><span class="line">sshd    2388 root    3r  IPv4  28216      0t0  TCP 123.57.238.142:12022-&gt;66.133.135.219.broad.gz.gd.dynamic.163data.com.cn:41068 (ESTABLISHED)</span><br><span class="line"></span><br><span class="line">可以看到端口已经修改过来了，再使用之前的命令就无法登录了</span><br><span class="line">$ ssh -p 22 root@123.57.238.142</span><br><span class="line">ssh: connect to host 123.57.238.142 port 22: Connection refused</span><br></pre></td></tr></table></figure>
<h3 id="ubuntu-连接到跳板机"><a href="#ubuntu-连接到跳板机" class="headerlink" title="ubuntu 连接到跳板机"></a>ubuntu 连接到跳板机</h3><p>先将密钥文件<code>hewentian.pem</code>放到用户SSH目录下<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> ~/.ssh</span><br><span class="line">$ cp ~/Downloads/hewentian.pem ./</span><br><span class="line"></span><br><span class="line">修改权限 </span><br><span class="line">$ chmod 600 hewentian.pem</span><br><span class="line"></span><br><span class="line">创建一个配置文件，如果没有的话</span><br><span class="line">$ touch config</span><br><span class="line"></span><br><span class="line">并在其中输入如下内容</span><br><span class="line">Host jump_server</span><br><span class="line">User hewentian</span><br><span class="line">Hostname 192.168.30.30</span><br><span class="line">Port 12022</span><br><span class="line">PreferredAuthentications publickey</span><br><span class="line">IdentityFile ~/.ssh/hewentian.pem</span><br></pre></td></tr></table></figure></p>
<p>这样，在使命行中输入: <code>ssh jump_server</code>就可以跳到跳板机了</p>
<h3 id="ubuntu-下-zssh-的使用"><a href="#ubuntu-下-zssh-的使用" class="headerlink" title="ubuntu 下 zssh 的使用"></a>ubuntu 下 zssh 的使用</h3><p>首先，ubuntu下需要安装下面两个包，如果还未安装的话：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt install lszrz</span><br><span class="line">$ sudo apt install zssh</span><br></pre></td></tr></table></figure></p>
<ol>
<li><p>使用 zssh 替代 ssh 连接到目标系统，并登入：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zssh jump_server</span><br></pre></td></tr></table></figure>
</li>
<li><p>发送文件到目标系统。比如，我们要上传a.txt文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">首先进入目标机的要上传到的目录，这里进入用户根目录下的Downloads</span><br><span class="line">$ <span class="built_in">cd</span> ~/Downloads</span><br><span class="line">（然后，按 ctrl + @ 进入文件传输状态，这个时候会浏览本地机器的文件系统了）</span><br><span class="line">zssh &gt; ls</span><br><span class="line">a.txt</span><br><span class="line">要将a.txt上传到目标机，执行如下命令即可</span><br><span class="line">zssh &gt; sz a.txt</span><br></pre></td></tr></table></figure>
</li>
<li><p>下载文件到本地。比如，我们想从目标系统下载 ~/Downloads/a.txt 到本地</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> ~/Downloads</span><br><span class="line">$ ls</span><br><span class="line">a.txt</span><br><span class="line"></span><br><span class="line">$ sz a.txt </span><br><span class="line">�B00000000000000</span><br><span class="line">（按 ctrl + @ 进入文件传输状态）</span><br><span class="line">zssh &gt; rz</span><br><span class="line">Receiving: a.txt                                                     </span><br><span class="line">Bytes received:       7/      7   BPS:1198                  </span><br><span class="line"></span><br><span class="line">Transfer complete</span><br><span class="line"></span><br><span class="line">$</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>在目标系统输入 sz 时，我们开启了文件发送，此处可能会有乱码，暂时不管；然后，按 Ctrl+@ 进入文件传输模式，输入 rz 并回车进行文件下载，下载完成后，自动退出文件传输模式</p>
<p>在自己的linux机上，如ubuntu等，安装上zssh，先用zssh登陆上跳板机，再在跳板机上ssh到相应服务器，然后ctrl+@,就可以相应上传下载文件了，先记着，后续再补详细资料。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">上传本地文件到服务器</span><br><span class="line">在服务器上先<span class="built_in">cd</span>至相应要放上传文件的目录之后</span><br><span class="line"></span><br><span class="line">rz -<span class="built_in">bye</span>                 //在远程服务器的相应目录上运行此命令,表示做好接收文件的准备</span><br><span class="line">ctrl+@                  //运行上面命令后,会出现一些乱码字符,不要怕,按此组合键,进入zssh</span><br><span class="line">zssh &gt;                  //这里切换到了本地机器</span><br><span class="line">zssh &gt; <span class="built_in">pwd</span>           //看一下本地机器的目录在那</span><br><span class="line">zssh &gt; ls               //看一下有那些文件</span><br><span class="line">zssh &gt; sz 123.txt   //上传本地机器的当前目录的123.txt到远程机器的当前目录</span><br><span class="line"></span><br><span class="line">下载服务器文件到本地</span><br><span class="line">sz filename             //在远程机器上,启动sz, 准备发送文件</span><br><span class="line">                               //看到一堆乱码,不要怕,这会按下组合键</span><br><span class="line">ctrl+@</span><br><span class="line">zssh &gt; <span class="built_in">pwd</span>              //看看在那个目录,<span class="built_in">cd</span> 切换到合适的目录</span><br><span class="line">zssh &gt; rz -<span class="built_in">bye</span>                 //接住对应的文件</span><br></pre></td></tr></table></figure></p>
<h3 id="Linux下打开ISO文件方法"><a href="#Linux下打开ISO文件方法" class="headerlink" title="Linux下打开ISO文件方法"></a>Linux下打开ISO文件方法</h3><p>Linux下用mount挂载命令<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mount -o loop /home/hewentian/Downloads/ubuntu.iso /mnt/cdrom</span><br></pre></td></tr></table></figure></p>
<p>取消挂载<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ umount /mnt/cdrom</span><br></pre></td></tr></table></figure></p>
<h3 id="Linux-统计当前文件夹下的文件个数、目录个数"><a href="#Linux-统计当前文件夹下的文件个数、目录个数" class="headerlink" title="Linux 统计当前文件夹下的文件个数、目录个数"></a>Linux 统计当前文件夹下的文件个数、目录个数</h3><p>1) 统计当前文件夹下文件的个数<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ls -l | grep <span class="string">"^-"</span> | wc -l</span><br></pre></td></tr></table></figure></p>
<p>2) 统计当前文件夹下目录的个数<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ls -l | grep <span class="string">"^d"</span> | wc -l</span><br></pre></td></tr></table></figure></p>
<p>3) 统计当前文件夹下文件的个数，包括子文件夹里的<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ls -lR | grep <span class="string">"^-"</span> | wc -l</span><br></pre></td></tr></table></figure></p>
<p>4) 统计文件夹下目录的个数，包括子文件夹里的<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ls -lR | grep <span class="string">"^d"</span> | wc -l</span><br></pre></td></tr></table></figure></p>
<p>说明：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ls -l</span><br></pre></td></tr></table></figure></p>
<p>长列表输出当前文件夹下文件信息(注意这里的文件，不同于一般的文件，可能是目录、链接、设备文件等)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ grep <span class="string">"^-"</span></span><br></pre></td></tr></table></figure>
<p>这里将长列表输出信息过滤一部分，只保留一般文件，如果只保留目录就是 ^d<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ wc -l</span><br></pre></td></tr></table></figure></p>
<p>统计输出信息的行数，因为已经过滤得只剩一般文件了，所以统计结果就是一般文件信息的行数，又由于一行信息对应一个文件，所以也就是文件的个数。</p>
<h3 id="安装opevpn"><a href="#安装opevpn" class="headerlink" title="安装opevpn"></a>安装opevpn</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">首先安装openvpn</span><br><span class="line">$ sudo apt install openvpn</span><br><span class="line"></span><br><span class="line">然后启动，其中~/Downloads/hewentian是你的公司下发的你自已的登录帐号相关的文件</span><br><span class="line">$ sudo openvpn ~/Downloads/hewentian/hewentian.ovpn</span><br></pre></td></tr></table></figure>
<p>这样，你在家里也可以连回公司的网络</p>
<h3 id="linux-查询-CPU-信息"><a href="#linux-查询-CPU-信息" class="headerlink" title="linux 查询 CPU 信息"></a>linux 查询 CPU 信息</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ cat /proc/cpuinfo | grep <span class="string">"model name"</span> &amp;&amp; cat /proc/cpuinfo | grep <span class="string">"physical id"</span></span><br><span class="line"></span><br><span class="line">model name	: Intel(R) Core(TM) i3-2350M CPU @ 2.30GHz</span><br><span class="line">model name	: Intel(R) Core(TM) i3-2350M CPU @ 2.30GHz</span><br><span class="line">model name	: Intel(R) Core(TM) i3-2350M CPU @ 2.30GHz</span><br><span class="line">model name	: Intel(R) Core(TM) i3-2350M CPU @ 2.30GHz</span><br><span class="line">physical id	: 0</span><br><span class="line">physical id	: 0</span><br><span class="line">physical id	: 0</span><br><span class="line">physical id	: 0</span><br></pre></td></tr></table></figure>
<h3 id="linux-查询-内存大小"><a href="#linux-查询-内存大小" class="headerlink" title="linux 查询 内存大小"></a>linux 查询 内存大小</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ cat /proc/meminfo | grep MemTotal</span><br><span class="line"></span><br><span class="line">MemTotal:        8115068 kB</span><br></pre></td></tr></table></figure>
<h3 id="linux-查询-硬盘大小"><a href="#linux-查询-硬盘大小" class="headerlink" title="linux 查询 硬盘大小"></a>linux 查询 硬盘大小</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ fdisk -l | grep Disk</span><br><span class="line"></span><br><span class="line">Disk /dev/sda: 119.2 GiB, 128035676160 bytes, 250069680 sectors</span><br><span class="line">Disklabel <span class="built_in">type</span>: dos</span><br><span class="line">Disk identifier: 0x07462b5e</span><br><span class="line">Disk /dev/sdb: 465.8 GiB, 500107862016 bytes, 976773168 sectors</span><br><span class="line">Disklabel <span class="built_in">type</span>: dos</span><br><span class="line">Disk identifier: 0x547aca8b</span><br></pre></td></tr></table></figure>
<h3 id="查看内存使用量和交换区使用量"><a href="#查看内存使用量和交换区使用量" class="headerlink" title="查看内存使用量和交换区使用量"></a>查看内存使用量和交换区使用量</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ free -m</span><br><span class="line">              total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:           7924        5783         472         331        1668        1460</span><br><span class="line">Swap:         15623        1176       14447</span><br></pre></td></tr></table></figure>
<h3 id="查看各分区使用情况"><a href="#查看各分区使用情况" class="headerlink" title="查看各分区使用情况"></a>查看各分区使用情况</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ df -h</span><br><span class="line">Filesystem      Size  Used Avail Use% Mounted on</span><br><span class="line">udev            3.9G     0  3.9G   0% /dev</span><br><span class="line">tmpfs           793M  9.4M  784M   2% /run</span><br><span class="line">/dev/sda2       102G   27G   71G  28% /</span><br><span class="line">tmpfs           3.9G  130M  3.8G   4% /dev/shm</span><br><span class="line">tmpfs           5.0M  4.0K  5.0M   1% /run/lock</span><br><span class="line">tmpfs           3.9G     0  3.9G   0% /sys/fs/cgroup</span><br><span class="line">/dev/sda1       464M  174M  263M  40% /boot</span><br><span class="line">tmpfs           793M  104K  793M   1% /run/user/1000</span><br></pre></td></tr></table></figure>
<h3 id="查看指定目录的大小"><a href="#查看指定目录的大小" class="headerlink" title="查看指定目录的大小"></a>查看指定目录的大小</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ du -sh</span><br><span class="line">4.5G	.</span><br><span class="line"></span><br><span class="line">还可以另上指定文件，这样就计算那个文件或目录的大小</span><br><span class="line">$ du -sh ROOT.zip </span><br><span class="line">67M	ROOT.zip</span><br></pre></td></tr></table></figure>
<h3 id="gpg-验证已下载文件的真实性和完整性"><a href="#gpg-验证已下载文件的真实性和完整性" class="headerlink" title="gpg 验证已下载文件的真实性和完整性"></a>gpg 验证已下载文件的真实性和完整性</h3><p>首先检查系统是否已经安装GPG<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ dpkg-query -l gnupg*</span><br></pre></td></tr></table></figure></p>
<p>否则使用如下命令安装(ubuntu)<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install gnupg</span><br></pre></td></tr></table></figure></p>
<p>安装完毕后，生成密钥对，要使用到你的用户名和邮箱，以及保护你私钥的密码，如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">$ gpg --gen-key</span><br><span class="line">gpg (GnuPG) 1.4.20; Copyright (C) 2015 Free Software Foundation, Inc.</span><br><span class="line">This is free software: you are free to change and redistribute it.</span><br><span class="line">There is NO WARRANTY, to the extent permitted by law.</span><br><span class="line"></span><br><span class="line">Please select what kind of key you want:</span><br><span class="line">   (1) RSA and RSA (default)</span><br><span class="line">   (2) DSA and Elgamal</span><br><span class="line">   (3) DSA (sign only)</span><br><span class="line">   (4) RSA (sign only)</span><br><span class="line">Your selection? </span><br><span class="line">RSA keys may be between 1024 and 4096 bits long.</span><br><span class="line">What keysize <span class="keyword">do</span> you want? (2048) </span><br><span class="line">Requested keysize is 2048 bits</span><br><span class="line">Please specify how long the key should be valid.</span><br><span class="line">         0 = key does not expire</span><br><span class="line">      &lt;n&gt;  = key expires <span class="keyword">in</span> n days</span><br><span class="line">      &lt;n&gt;w = key expires <span class="keyword">in</span> n weeks</span><br><span class="line">      &lt;n&gt;m = key expires <span class="keyword">in</span> n months</span><br><span class="line">      &lt;n&gt;y = key expires <span class="keyword">in</span> n years</span><br><span class="line">Key is valid <span class="keyword">for</span>? (0) </span><br><span class="line">Key does not expire at all</span><br><span class="line">Is this correct? (y/N) y</span><br><span class="line"></span><br><span class="line">You need a user ID to identify your key; the software constructs the user ID</span><br><span class="line">from the Real Name, Comment and Email Address <span class="keyword">in</span> this form:</span><br><span class="line">    <span class="string">"Heinrich Heine (Der Dichter) &lt;heinrichh@duesseldorf.de&gt;"</span></span><br><span class="line"></span><br><span class="line">Real name: Tim Ho</span><br><span class="line">Email address: wentian.he@qq.com</span><br><span class="line">Comment: </span><br><span class="line">You selected this USER-ID:</span><br><span class="line">    <span class="string">"Tim Ho &lt;wentian.he@qq.com&gt;"</span></span><br><span class="line"></span><br><span class="line">Change (N)ame, (C)omment, (E)mail or (O)kay/(Q)uit? O</span><br><span class="line">You need a Passphrase to protect your secret key.</span><br><span class="line"></span><br><span class="line">We need to generate a lot of random bytes. It is a good idea to perform</span><br><span class="line">some other action (<span class="built_in">type</span> on the keyboard, move the mouse, utilize the</span><br><span class="line">disks) during the prime generation; this gives the random number</span><br><span class="line">generator a better chance to gain enough entropy.</span><br><span class="line">.........+++++</span><br><span class="line">+++++</span><br><span class="line">We need to generate a lot of random bytes. It is a good idea to perform</span><br><span class="line">some other action (<span class="built_in">type</span> on the keyboard, move the mouse, utilize the</span><br><span class="line">disks) during the prime generation; this gives the random number</span><br><span class="line">generator a better chance to gain enough entropy.</span><br><span class="line">+++++</span><br><span class="line"></span><br><span class="line">Not enough random bytes available.  Please <span class="keyword">do</span> some other work to give</span><br><span class="line">the OS a chance to collect more entropy! (Need 73 more bytes)</span><br><span class="line">+++++</span><br><span class="line">gpg: key 46DC4BA0 marked as ultimately trusted</span><br><span class="line">public and secret key created and signed.</span><br><span class="line"></span><br><span class="line">gpg: checking the trustdb</span><br><span class="line">gpg: 3 marginal(s) needed, 1 complete(s) needed, PGP trust model</span><br><span class="line">gpg: depth: 0  valid:   2  signed:   0  trust: 0-, 0q, 0n, 0m, 0f, 2u</span><br><span class="line">pub   2048R/46DC4BA0 2018-01-14</span><br><span class="line">      Key fingerprint = 06F1 0995 A7FE DF6F 007F  CE59 B307 E8C8 46DC 4BA0</span><br><span class="line">uid                  Tim Ho &lt;wentian.he@qq.com&gt;</span><br><span class="line">sub   2048R/74EB06EB 2018-01-14</span><br></pre></td></tr></table></figure></p>
<p>密钥生成完毕后，公钥和私钥都将存储在~/.gnupg目录中，供之后使用。</p>
<p>导入文件所有者的公钥<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ gpg --import rabbitmq-release-signing-key.asc </span><br><span class="line">gpg: key 6026DFCA: <span class="string">"RabbitMQ Release Signing Key &lt;info@rabbitmq.com&gt;"</span> not changed</span><br><span class="line">gpg: Total number processed: 1</span><br><span class="line">gpg:              unchanged: 1</span><br></pre></td></tr></table></figure></p>
<p>当所有者的公钥导入完毕，它会输出一个密钥编号(比如“6026DFCA”)，如上所示</p>
<p>现在，运行这个命令，检查已导入公钥的指纹：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ gpg --fingerprint 6026DFCA</span><br><span class="line">pub   4096R/6026DFCA 2016-05-17</span><br><span class="line">      Key fingerprint = 0A9A F211 5F46 87BD 2980  3A20 6B73 A36E 6026 DFCA</span><br><span class="line">uid                  RabbitMQ Release Signing Key &lt;info@rabbitmq.com&gt;</span><br><span class="line">sub   4096R/12EBCE19 2016-05-17</span><br></pre></td></tr></table></figure></p>
<p>检查上面的指纹是否与所有者官网提供的一致。</p>
<p>下面的步骤可选，<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ gpg --edit-key 6026DFCA</span><br><span class="line">gpg (GnuPG) 1.4.20; Copyright (C) 2015 Free Software Foundation, Inc.</span><br><span class="line">This is free software: you are free to change and redistribute it.</span><br><span class="line">There is NO WARRANTY, to the extent permitted by law.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pub  4096R/6026DFCA  created: 2016-05-17  expires: never       usage: SC  </span><br><span class="line">                     trust: full          validity: unknown</span><br><span class="line">sub  4096R/12EBCE19  created: 2016-05-17  expires: never       usage: E   </span><br><span class="line">[ unknown] (1). RabbitMQ Release Signing Key &lt;info@rabbitmq.com&gt;</span><br></pre></td></tr></table></figure></p>
<p>在GPG提示符下键入“trust”，这会让你可以选择该密钥的信任级别：从1到5，这里选择4<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">gpg&gt; trust</span><br><span class="line">pub  4096R/6026DFCA  created: 2016-05-17  expires: never       usage: SC  </span><br><span class="line">                     trust: full          validity: unknown</span><br><span class="line">sub  4096R/12EBCE19  created: 2016-05-17  expires: never       usage: E   </span><br><span class="line">[ unknown] (1). RabbitMQ Release Signing Key &lt;info@rabbitmq.com&gt;</span><br><span class="line"></span><br><span class="line">Please decide how far you trust this user to correctly verify other users<span class="string">' keys</span></span><br><span class="line"><span class="string">(by looking at passports, checking fingerprints from different sources, etc.)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  1 = I don'</span>t know or won<span class="string">'t say</span></span><br><span class="line"><span class="string">  2 = I do NOT trust</span></span><br><span class="line"><span class="string">  3 = I trust marginally</span></span><br><span class="line"><span class="string">  4 = I trust fully</span></span><br><span class="line"><span class="string">  5 = I trust ultimately</span></span><br><span class="line"><span class="string">  m = back to the main menu</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Your decision? 4</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">pub  4096R/6026DFCA  created: 2016-05-17  expires: never       usage: SC  </span></span><br><span class="line"><span class="string">                     trust: full          validity: unknown</span></span><br><span class="line"><span class="string">sub  4096R/12EBCE19  created: 2016-05-17  expires: never       usage: E   </span></span><br><span class="line"><span class="string">[ unknown] (1). RabbitMQ Release Signing Key &lt;info@rabbitmq.com&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">gpg&gt; sign</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">pub  4096R/6026DFCA  created: 2016-05-17  expires: never       usage: SC  </span></span><br><span class="line"><span class="string">                     trust: full          validity: unknown</span></span><br><span class="line"><span class="string"> Primary key fingerprint: 0A9A F211 5F46 87BD 2980  3A20 6B73 A36E 6026 DFCA</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">     RabbitMQ Release Signing Key &lt;info@rabbitmq.com&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Are you sure that you want to sign this key with your</span></span><br><span class="line"><span class="string">key "Tim Ho &lt;wentian.he@qq.com&gt;" (E99DCF91)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Really sign? (y/N) y</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">You need a passphrase to unlock the secret key for</span></span><br><span class="line"><span class="string">user: "Tim Ho &lt;wentian.he@qq.com&gt;"</span></span><br><span class="line"><span class="string">2048-bit RSA key, ID E99DCF91, created 2018-01-14</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">gpg&gt; save</span></span><br></pre></td></tr></table></figure></p>
<p>然后sign，最后save，这里输入的passphrase错误，与我之前的密码不符，未明原因。<br>最后，查看导入的keys<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ gpg --list-keys</span><br><span class="line">/home/hewentian/.gnupg/pubring.gpg</span><br><span class="line">----------------------------------</span><br><span class="line">pub   2048R/E99DCF91 2018-01-14</span><br><span class="line">uid                  Tim Ho &lt;wentian.he@qq.com&gt;</span><br><span class="line">sub   2048R/6F7627AD 2018-01-14</span><br><span class="line"></span><br><span class="line">pub   4096R/6026DFCA 2016-05-17</span><br><span class="line">uid                  RabbitMQ Release Signing Key &lt;info@rabbitmq.com&gt;</span><br><span class="line">sub   4096R/12EBCE19 2016-05-17</span><br><span class="line"></span><br><span class="line">pub   2048R/46DC4BA0 2018-01-14</span><br><span class="line">uid                  Tim Ho &lt;wentian.he@qq.com&gt;</span><br><span class="line">sub   2048R/74EB06EB 2018-01-14</span><br></pre></td></tr></table></figure></p>
<p>最后：验证文件的真实性/完整性<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ gpg --verify rabbitmq-server_3.7.2-1_all.deb.asc rabbitmq-server_3.7.2-1_all.deb</span><br><span class="line">gpg: Signature made Sat 23 Dec 2017 03:03:34 PM CST using RSA key ID 6026DFCA</span><br><span class="line">gpg: checking the trustdb</span><br><span class="line">gpg: 3 marginal(s) needed, 1 complete(s) needed, PGP trust model</span><br><span class="line">gpg: depth: 0  valid:   2  signed:   0  trust: 0-, 0q, 0n, 0m, 0f, 2u</span><br><span class="line">gpg: Good signature from <span class="string">"RabbitMQ Release Signing Key &lt;info@rabbitmq.com&gt;"</span></span><br><span class="line">gpg: WARNING: This key is not certified with a trusted signature!</span><br><span class="line">gpg:          There is no indication that the signature belongs to the owner.</span><br><span class="line">Primary key fingerprint: 0A9A F211 5F46 87BD 2980  3A20 6B73 A36E 6026 DFCA</span><br></pre></td></tr></table></figure></p>
<p>该命令的输出里面含有“Good signature from ”，这表明已下载的.deb文件已成功通过了验证。要是已下载文件在签名生成后以任何一种方式而遭到篡改，验证就会失败。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/hewentian/2017/09/12/linux-note/" data-id="cjcpkyc8j000ay02invbkxgfn" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/">Linux</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-online-implementing" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/09/12/online-implementing/" class="article-date">
  <time datetime="2017-09-12T12:22:54.000Z" itemprop="datePublished">2017-09-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/java/">java</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/12/online-implementing/">系统上线注意事项</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="上线总结："><a href="#上线总结：" class="headerlink" title="上线总结："></a>上线总结：</h2><p>今天下午准备上线，折腾了很久， 不过， 终于成功上线，期间发现了很多问题。所谓好记性，不如烂笔头，故记之。有时候，系统上线，如果发现还是旧的页面，可能会是缓存，这时候，要检查下下面的地方：</p>
<h3 id="1-你浏览器的缓存是否已经清掉了；"><a href="#1-你浏览器的缓存是否已经清掉了；" class="headerlink" title="1. 你浏览器的缓存是否已经清掉了；"></a>1. 你浏览器的缓存是否已经清掉了；</h3><h3 id="2-Tomcat-的缓存是否清掉了-TOMCAT-HOME-work-这个目录，放的就是-Tomcat-的缓存；"><a href="#2-Tomcat-的缓存是否清掉了-TOMCAT-HOME-work-这个目录，放的就是-Tomcat-的缓存；" class="headerlink" title="2. Tomcat 的缓存是否清掉了 ${TOMCAT_HOME}/work 这个目录，放的就是 Tomcat 的缓存；"></a>2. Tomcat 的缓存是否清掉了 ${TOMCAT_HOME}/work 这个目录，放的就是 Tomcat 的缓存；</h3><h3 id="3-如果-IP-PORT-访问，没问题的话，有可能是-CDN-缓存了，这时候也要刷下-CDN；"><a href="#3-如果-IP-PORT-访问，没问题的话，有可能是-CDN-缓存了，这时候也要刷下-CDN；" class="headerlink" title="3. 如果 IP + PORT 访问，没问题的话，有可能是 CDN 缓存了，这时候也要刷下 CDN；"></a>3. 如果 IP + PORT 访问，没问题的话，有可能是 CDN 缓存了，这时候也要刷下 CDN；</h3>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/hewentian/2017/09/12/online-implementing/" data-id="cjcpkyc92000ly02i00c8ry60" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/">java</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-tomcat-note" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/09/11/tomcat-note/" class="article-date">
  <time datetime="2017-09-11T02:21:02.000Z" itemprop="datePublished">2017-09-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/java/">java</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/11/tomcat-note/">tomcat 学习笔记</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="tomcat-登录用户名-与-密码设置"><a href="#tomcat-登录用户名-与-密码设置" class="headerlink" title="tomcat 登录用户名 与 密码设置"></a>tomcat 登录用户名 与 密码设置</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">403 Access Denied</span><br><span class="line"></span><br><span class="line">You are not authorized to view this page.</span><br><span class="line"></span><br><span class="line">If you have already configured the Host Manager application to allow access and you have used your browsers back button, used a saved book-mark or similar then you may have triggered the cross-site request forgery (CSRF) protection that has been enabled for the HTML interface of the Host Manager application. You will need to reset this protection by returning to the main Host Manager page. Once you return to this page, you will be able to continue using the Host Manager application's HTML interface normally. If you continue to see this access denied message, check that you have the necessary permissions to access this application.</span><br><span class="line"></span><br><span class="line">If you have not changed any configuration files, please examine the file conf/tomcat-users.xml in your installation. That file must contain the credentials to let you use this webapp.</span><br><span class="line"></span><br><span class="line">For example, to add the admin-gui role to a user named tomcat with a password of s3cret, add the following to the config file listed above.</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">role</span> <span class="attr">rolename</span>=<span class="string">"admin-gui"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">user</span> <span class="attr">username</span>=<span class="string">"tomcat"</span> <span class="attr">password</span>=<span class="string">"s3cret"</span> <span class="attr">roles</span>=<span class="string">"admin-gui"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">Note that for Tomcat 7 onwards, the roles required to use the host manager application were changed from the single admin role to the following two roles. You will need to assign the role(s) required for the functionality you wish to access.</span><br><span class="line"></span><br><span class="line">admin-gui - allows access to the HTML GUI</span><br><span class="line">admin-script - allows access to the text interface</span><br><span class="line">The HTML interface is protected against CSRF but the text interface is not. To maintain the CSRF protection:</span><br><span class="line"></span><br><span class="line">Users with the admin-gui role should not be granted the admin-script role.</span><br><span class="line">If the text interface is accessed through a browser (e.g. for testing since this interface is intended for tools not humans) then the browser must be closed afterwards to terminate the session.</span><br></pre></td></tr></table></figure>
<p>Tomcat Manager是Tomcat自带的、用于对Tomcat自身以及部署在Tomcat上的应用进行管理的web应用。<br>在默认情况下，Tomcat Manager是处于禁用状态的。准确地说，Tomcat Manager需要以用户角色进行<br>登录并授权才能使用相应的功能，不过Tomcat并没有配置任何默认的用户，因此需要我们进行相应的<br>用户配置之后才能使用Tomcat Manager。</p>
<p>在使用Tomcat时，我们通过点击 <a href="http://localhost:8080/" target="_blank" rel="noopener">http://localhost:8080/</a> 下面的【Host Manager】可以管理Tomcat服务器中的web工程；</p>
<p>设置用户名、有密码的方法：</p>
<p>1、登录用户名和密码我们需要在 目录：${TOMCAT_HOME}/conf/tomcat-users.xml 中修改如下配置：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">role</span> <span class="attr">rolename</span>=<span class="string">"admin-gui"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">user</span> <span class="attr">username</span>=<span class="string">"tomcat"</span> <span class="attr">password</span>=<span class="string">"s3cret"</span> <span class="attr">roles</span>=<span class="string">"admin-gui"</span>/&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>2、进入当前目录下的：context.xml 文件，并作如下修改（其实这一步，可以省略的）<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;  </span><br><span class="line">    <span class="tag">&lt;<span class="name">WatchedResource</span>&gt;</span>WEB-INF/web.xml<span class="tag">&lt;/<span class="name">WatchedResource</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">Manager</span> <span class="attr">pathname</span>=<span class="string">"/manager"</span> <span class="attr">debug</span>=<span class="string">"0"</span>  <span class="attr">privileged</span>=<span class="string">"true"</span> <span class="attr">docBase</span>=<span class="string">"$&#123;TOMCAT_HOME&#125;/webapps/manager"</span> /&gt;</span>      </span><br><span class="line">    <span class="tag">&lt;<span class="name">Valve</span> <span class="attr">className</span>=<span class="string">"org.apache.catalina.valves.CometConnectionManagerValve"</span> /&gt;</span>    </span><br><span class="line"><span class="tag">&lt;/<span class="name">Context</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>完成这两步之后，重启tomcat ，输入刚才设置的用户名和密码，即可登录Tomcat 管理web project</p>
<h3 id="tomcat配置访问项目时不需要加项目名称"><a href="#tomcat配置访问项目时不需要加项目名称" class="headerlink" title="tomcat配置访问项目时不需要加项目名称"></a>tomcat配置访问项目时不需要加项目名称</h3><p>访问JAVA WEB项目的时候，需要在地址中添加项目名称，可以去掉项目名称直接访问项目<br>目前有两种方式：<br>方式1: 修改<code>${TOMCAT_HOME}/conf</code>目录下的<code>server.xml</code>配置<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Host</span> <span class="attr">name</span>=<span class="string">"localhost"</span> <span class="attr">appBase</span>=<span class="string">"webapps"</span> <span class="attr">unpackWARs</span>=<span class="string">"true"</span> <span class="attr">autoDeploy</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- path留空代表访问域名后面不需要带项目的名称 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">Context</span> <span class="attr">path</span>=<span class="string">""</span> <span class="attr">docBase</span>=<span class="string">"/home/hewentian/ProjectD/brandSearch"</span> <span class="attr">reloadable</span>=<span class="string">"true"</span> /&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">Host</span>&gt;</span></span><br><span class="line"></span><br><span class="line">说明：</span><br><span class="line">path: 代表访问时的项目名称</span><br><span class="line">docBase: 代表项目的绝对路径，也可以使用相对路径</span><br></pre></td></tr></table></figure></p>
<p>方式2：将项目下的文件复制放到<code>${TOMCAT_HOME}/webapps/ROOT</code>目录下<br>所有的项目都在webapps目录里面，ROOT是其中的一个项目，浏览器访问<code>http://localhost:8080/</code>其实是默认访问ROOT项目。</p>
<h3 id="tomcat配置图片目录"><a href="#tomcat配置图片目录" class="headerlink" title="tomcat配置图片目录"></a>tomcat配置图片目录</h3><p>修改<code>${TOMCAT_HOME}/conf</code>目录下的<code>server.xml</code>配置<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Host</span> <span class="attr">name</span>=<span class="string">"localhost"</span> <span class="attr">appBase</span>=<span class="string">"webapps"</span> <span class="attr">unpackWARs</span>=<span class="string">"true"</span> <span class="attr">autoDeploy</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">Context</span> <span class="attr">path</span>=<span class="string">"img"</span> <span class="attr">docBase</span>=<span class="string">"/home/hewentian/Pictures"</span> <span class="attr">reloadable</span>=<span class="string">"false"</span> &gt;</span><span class="tag">&lt;/<span class="name">Context</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Host</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>这样当你在浏览器中访问<code>http://localhost:8080/img/{指定图片名}</code>的时候就会访问到<code>/home/hewentian/Pictures</code>目录下面的图片</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/hewentian/2017/09/11/tomcat-note/" data-id="cjcpkyca3001by02irqt2dbjm" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/tomcat/">tomcat</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <a class="extend prev" rel="prev" href="/">&laquo; __('prev')</a><a class="page-number" href="/">1</a><span class="page-number current">2</span>
  </nav>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/bigdata/">bigdata</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/db/">db</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/">java</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/">other</a><span class="category-list-count">5</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">一月 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">十二月 2017</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">十一月 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">十月 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">九月 2017</a><span class="archive-list-count">4</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/01/17/rabbitmq-note/">rabbitMQ学习笔记</a>
          </li>
        
          <li>
            <a href="/2018/01/08/solr-ikanalyzer/">solr配置IKAnalyzer的中文分词</a>
          </li>
        
          <li>
            <a href="/2018/01/08/solr-pinyin/">solr配置拼音检索</a>
          </li>
        
          <li>
            <a href="/2017/12/08/install-jdk/">安装 JDK</a>
          </li>
        
          <li>
            <a href="/2017/12/07/mysql-note/">mysql 笔记</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">link</h3>
    <div class="widget">
      <li><a href="https://github.com/hewentian" title="Tim Ho's Blog">我的github</a></li>
    </div>
  </div>


  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 Tim Ho<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives/" class="mobile-nav-link">Archives</a>
  
    <a href="/categories/" class="mobile-nav-link">Categories</a>
  
    <a href="/tags/" class="mobile-nav-link">Tags</a>
  
    <a href="/about/" class="mobile-nav-link">About</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>